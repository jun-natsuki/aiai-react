<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AiAi â€” í•œÂ·ì¼ ê²°í˜¼/êµì œ ë§¤ì¹­ (MVP)</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://dvwbrfknrptjepolbbwy.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR2d2JyZmtucnB0amVwb2xiYnd5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NDE0OTUsImV4cCI6MjA3MjIxNzQ5NX0.qRkMGQaQhWM97TiTHj5orCfxKKWA1m_amxzForDq43g";
    let sb = null;
    if (window.supabase) {
      sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    }
  </script>
  <style>
    /* ---------- Design tokens ---------- */
    :root{
      --bg:#ffffff;
      --panel:#ffffff;
      --card:#ffffff;
      --muted:#6b7280;
      --text:#0b0f19;
      --accent:#111111;
      --accent-2:#e5e7eb;
      --good:#16a34a;
      --bad:#dc2626;
      --border:#e5e7eb;
      --shadow: 0 8px 30px rgba(0,0,0,.06);
      --radius: 16px;
    }

    /* ---------- Base ---------- */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#f0f4f8,#fff);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,'Noto Sans KR','Apple SD Gothic Neo',Arial,sans-serif}
    a{color:inherit}

    /* ---------- Header / Nav ---------- */
    header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.9);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
    .bar{max-width:1100px;margin:auto;display:flex;gap:12px;align-items:center;justify-content:space-between;padding:12px 16px}
    .brand{font-weight:800;letter-spacing:.2px;display:flex;align-items:center;gap:12px;text-decoration:none}
    .brand .brand-sub{font-size:18px;line-height:1.2}

    nav{display:flex;gap:18px;flex-wrap:wrap;align-items:center}
    .navlink{display:inline-flex;align-items:center;font-size:16px;font-weight:700;background:transparent;border:none;padding:8px 0;color:var(--text);cursor:pointer;text-decoration:none}
    .navlink:hover{text-decoration:underline}
    .navlink[aria-current="page"]{text-decoration:underline 2px}

    /* ---------- Layout ---------- */
    main.container{max-width:1100px;margin:20px auto;padding:0 16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:22px;box-shadow:var(--shadow)}
    .hero{text-align:center;display:grid;grid-template-columns:1fr;gap:16px}
    #home > .card{margin:16px 0}

    .grid{display:grid;grid-template-columns:repeat(12,minmax(0,1fr));gap:12px}
    .sm-3{grid-column:span 3}
    .sm-4{grid-column:span 4}
    .sm-6{grid-column:span 6}
    .sm-8{grid-column:span 8}
    .sm-12{grid-column:span 12}

    .features-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px}
    .feat{display:flex;gap:12px;align-items:flex-start;padding:14px;border:1px solid var(--border);border-radius:12px}
    .feat .ico{font-size:22px;line-height:1}

    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    /* ---------- Type helpers ---------- */
    .kicker{font-size:14px;color:var(--muted);margin:0 0 8px}
    .headline{font-size:36px;line-height:1.2;margin:0 0 10px;color:#0b0f19}
    .sub{color:#4b5563;margin:0 0 14px}
    .muted{color:var(--muted)}
    .help{font-size:14px;color:var(--muted)}
    .divider{height:1px;background:var(--border);margin:16px 0}

    /* ---------- Buttons ---------- */
    .btn{appearance:none;border:1px solid var(--border);background:#fff;color:#111;padding:10px 14px;border-radius:999px;cursor:pointer;font-weight:700;transition:transform .15s,box-shadow .15s}
    .btn:hover{background:#fafafa;transform:scale(1.05);box-shadow:0 2px 6px rgba(0,0,0,.1)}
    .primary{border-color:#111;background:#111;color:#fff}
    .primary:hover{opacity:.9}
    .ghost{background:transparent}

    .navlink,.brand{transition:transform .15s}
    .navlink:hover,.brand:hover{transform:scale(1.05)}
    .brand{cursor:pointer}

    /* ---------- Forms ---------- */
    .input-row{display:flex;flex-direction:column;gap:6px;margin:10px 0}
    label.req::after{content:' *';color:var(--bad)}
    input,select{width:100%;padding:12px 12px;border:1px solid var(--border);border-radius:12px;font-size:16px}
    .sticky-cta{position:sticky;bottom:10px;justify-content:flex-end;background:linear-gradient(180deg,rgba(255,255,255,0),#fff 40%);padding-top:8px}

    /* ---------- Badges ---------- */
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);font-weight:700;font-size:13px}
    .badge.warn{background:#fffbea;border-color:#fef3c7;color:#92400e}
    .badge.good{background:#ecfdf5;border-color:#d1fae5;color:#065f46}

    /* ---------- Avatars / Pills / Lists ---------- */
    .avatar{width:72px;height:72px;border-radius:14px;border:1px solid var(--border);object-fit:cover;background:#fff}
    .list{display:flex;flex-direction:column;gap:6px}
    .pill{display:flex;align-items:center;justify-content:space-between;gap:6px;border:1px solid var(--border);border-radius:8px;padding:6px 10px;font-size:14px;width:100%;white-space:nowrap}
    .chat-row{display:flex;align-items:flex-end;margin:6px 0}
    .bubble{padding:8px 12px;border-radius:16px;max-width:70%;word-wrap:break-word}
    .mine{background:#2563eb;color:#fff;margin-left:auto}
    .theirs{background:#e5e7eb;color:#111}
    .chat-avatar{width:32px;height:32px;border-radius:50%;margin:0 6px;object-fit:cover}

    /* ---------- Toast ---------- */
    .toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:999px;display:none;z-index:20}

    /* ---------- Modal ---------- */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:30}
    .modal .inner{background:#fff;border-radius:16px;border:1px solid var(--border);padding:18px;max-width:420px;width:90%}

    /* ---------- Footer ---------- */
    footer{border-top:1px solid var(--border);background:#fff}
    footer .foot-wrap{max-width:1100px;margin:0 auto;padding:18px 16px;display:flex;justify-content:center;gap:12px;flex-wrap:wrap}

    /* ---------- Responsive ---------- */
    @media (max-width: 900px){
      .features-grid{grid-template-columns:1fr 1fr}
      .sm-3,.sm-4,.sm-6,.sm-8{grid-column:span 12}
      .headline{font-size:30px}
    }
    @media (max-width: 520px){
      .features-grid{grid-template-columns:1fr}
      .brand .brand-sub{font-size:16px}
    }
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <a class="brand" href="#home" onclick="event.preventDefault(); ui.go('home');">
        <!-- ë¡œê³  ì´ë¯¸ì§€ ì œê±°(ìš”ì²­) -->
        <span class="brand-sub">Ai<b>Ai</b> ì•„ì´ì•„ì´ â€¢ <span lang="ja">ç›¸æ„›</span> â€¢ í•œì¼ê²°í˜¼ì •ë³´</span>
      </a>
      <div class="row" style="gap:8px;align-items:center">
        <div id="userBadge" class="badge warn" data-i18n="badgeLoggedOut"></div>
        <select id="langSel">
          <option value="ko">í•œêµ­ì–´</option>
          <option value="ja">æ—¥æœ¬èª</option>
        </select>
      </div>
    </div>
    <div class="bar" style="padding-top:0">
      <nav>
        <a id="nav-home" class="navlink" data-i18n="navHome" href="#home" onclick="event.preventDefault(); ui.go('home');">í™ˆ</a>
        <a id="nav-login" class="navlink" data-i18n="navLogin" href="#auth" onclick="event.preventDefault(); ui.openAuth();">ë¡œê·¸ì¸</a>
        <a id="nav-profile" class="navlink" data-i18n="navProfile" href="#profile" onclick="event.preventDefault(); ui.goProtected('profile');">í”„ë¡œí•„</a>
        <a id="nav-match" class="navlink" data-i18n="navMatch" href="#match" onclick="event.preventDefault(); ui.goProtected('match');">ë§¤ì¹­</a>
        <a id="nav-chat" class="navlink" data-i18n="navChat" href="#chat" onclick="event.preventDefault(); ui.goProtected('chat');">ëŒ€í™”</a>
        <a id="nav-logout" class="navlink" data-i18n="navLogout" href="#logout" onclick="event.preventDefault(); ui.logout();" style="display:none">ë¡œê·¸ì•„ì›ƒ</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <!-- HOME -->
    <section id="home">
      <div class="card hero">
        <div>
          <p class="kicker">AiAi â€” Korea â‡” Japan</p>
          <h1 class="headline" data-i18n="heroTitle">ê°„ë‹¨íˆ ì‹œì‘í•˜ëŠ” <b>ì§„ì§€í•œ ë§Œë‚¨</b></h1>
          <p class="sub" data-i18n="heroSub">AI 1ì°¨ ì ìˆ˜ + ë§¤ë‹ˆì € ìµœì¢… ë§¤ì¹­. <b>10ë¶„ ë‚´ ë§¤ì¹­</b>ì„ ì•½ì†í•˜ëŠ” í•œÂ·ì¼ ê²°í˜¼/êµì œ ì„œë¹„ìŠ¤.</p>
          <div class="row" style="justify-content:center">
            <button id="start-btn" class="btn primary" data-i18n="start" onclick="ui.start()">ì§€ê¸ˆ ì‹œì‘í•˜ê¸°</button>
          </div>
        </div>
        <div>
          <p class="kicker" data-i18n="taglineTitle">ì˜ˆë¹„ ì‹ ë¶€ë“¤ì´ ë‹¹ì‹ ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.</p>
          <p class="sub" data-i18n="taglineDesc">ë¬¸í™” êµë¥˜ì˜ í™œë°œí™”, í•­ê³µí¸ì˜ ë°œë‹¬, K-POPê³¼ ì• ë‹ˆë©”ì´ì…˜ ì¸ê¸° ë“±ìœ¼ë¡œ í•œì¼ ê²°í˜¼ ì„±ì‚¬ìœ¨ì´ ë¹ ë¥´ê²Œ ë†’ì•„ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>
        </div>
      </div>
      <div id="profileCTA" class="card" style="display:none;text-align:center">
        <p class="sub" data-i18n="profileCtaMsg">ë¨¼ì € í”„ë¡œí•„ì„ ì‘ì„±í•˜ì„¸ìš”</p>
        <button class="btn primary" data-i18n="profileCtaBtn" onclick="ui.go('profile')">í”„ë¡œí•„ ì‘ì„±</button>
      </div>

      <div class="card features">
        <h2 style="margin-top:0" data-i18n="featuresTitle">AiAiì˜ ê°•ì </h2>
        <div class="features-grid">
          <div class="feat"><div class="ico">â±ï¸</div><div><b data-i18n="feat1Title">10ë¶„ ë‚´ ë§¤ì¹­</b><div class="muted" data-i18n="feat1Desc">AI ìŠ¤ì½”ì–´ë§ í›„ ë§¤ë‹ˆì €ê°€ ìµœì¢… ì„ íƒ</div></div></div>
          <div class="feat"><div class="ico">ğŸ—£ï¸</div><div><b data-i18n="feat2Title">ìë™ ë²ˆì—­ ì±„íŒ…</b><div class="muted" data-i18n="feat2Desc">KOâ‡„JA ì‹¤ì‹œê°„ ëŒ€í™”ë¡œ<br>ìƒëŒ€ì˜ í˜¸ê°ì„ ë¨¼ì € í™•ì¸í•˜ì„¸ìš”</div></div></div>
          <div class="feat"><div class="ico">ğŸ›¡ï¸</div><div><b data-i18n="feat3Title">ì•ˆì „ ê²€ì¦</b><div class="muted" data-i18n="feat3Desc">ë³¸ì¸ì¸ì¦ + ìš´ì˜ì ê²€ìˆ˜</div></div></div>
          <div class="feat"><div class="ico">ğŸ¯</div><div><b data-i18n="feat4Title">ì •êµí•œ ì´ìƒí˜•</b><div class="muted" data-i18n="feat4Desc">ì„±ê²© ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ìì‹ ê³¼<br>ê°€ì¥ ì˜ ë§ëŠ” ì‚¬ëŒì„ ì°¾ì•„ë³´ì„¸ìš”</div></div></div>
          <div class="feat"><div class="ico">ğŸŒ</div><div><b data-i18n="feat5Title">í•œÂ·ì¼ êµ­ì œ ê²°í˜¼ ì§€ì›</b><div class="muted" data-i18n="feat5Desc">ê²°í˜¼ ê´€ë ¨ ë²•ë¥ /ì„œë¥˜,<br>ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”</div></div></div>
          <div class="feat"><div class="ico">ğŸ“…</div><div><b data-i18n="feat6Title">ë§Œë‚¨ ìŠ¤ì¼€ì¤„ë§</b><div class="muted" data-i18n="feat6Desc">ì˜¤í”„ë¼ì¸/ZOOM ì¼ì • ì¡°ìœ¨</div></div></div>
        </div>
      </div>

      <div class="card">
        <h2 style="margin-top:0" data-i18n="whyTitle">ì™œ AiAiì¸ê°€ìš”?</h2>
        <div class="grid">
          <div class="sm-4 card"><h3 data-i18n="why1Title">â‘  10ë¶„ ë‚´ ë§¤ì¹­</h3><p class="muted" data-i18n="why1Desc">AI ì ìˆ˜ë¡œ ìƒìœ„ í›„ë³´ ì„ ë³„ í›„ ë§¤ë‹ˆì €ê°€ ìµœì¢… ì„ íƒ.</p></div>
          <div class="sm-4 card"><h3 data-i18n="why2Title">â‘¡ ë²ˆì—­ ê±±ì • ë</h3><p class="muted" data-i18n="why2Desc">ëŒ€í™”ì°½ì—ì„œ ìë™ ë²ˆì—­(ëª¨ì˜)ë¡œ ì–¸ì–´ ì¥ë²½ ìµœì†Œí™”.</p></div>
          <div class="sm-4 card"><h3 data-i18n="why3Title">â‘¢ ì•ˆì‹¬ ì„œë¹„ìŠ¤</h3><p class="muted" data-i18n="why3Desc">ë³¸ì¸ì¸ì¦ê³¼ ìš´ì˜ì ê²€ìˆ˜ë¡œ ìœ ë ¹ ê³„ì •/ë¦¬ìŠ¤í¬ ê°ì†Œ.</p></div>
        </div>
      </div>

      <div class="card">
        <h2 style="margin-top:0" data-i18n="flowTitle">ì´ìš© ìˆœì„œ</h2>
        <div class="grid">
          <div class="sm-3 card"><h3 data-i18n="flow1Title">1. ê°€ì…/ì¸ì¦</h3><p class="muted" data-i18n="flow1Desc">ì´ë©”ì¼Â·ë¹„ë²ˆ ì…ë ¥ í›„ ì¸ì¦.</p></div>
          <div class="sm-3 card"><h3 data-i18n="flow2Title">2. ì •ë³´ ê¸°ì…</h3><p class="muted" data-i18n="flow2Desc">ê¸°ë³¸Â·ë‚´ í”„ë¡œí•„Â·ì´ìƒí˜• í”„ë¡œí•„ 3ë‹¨ê³„.</p></div>
          <div class="sm-3 card"><h3 data-i18n="flow3Title">3. ë§¤ì¹­ ì‹ ì²­</h3><p class="muted" data-i18n="flow3Desc">í›„ë³´ 5ëª… ì¶”ì²œ â†’ ì„ íƒ.</p></div>
          <div class="sm-3 card"><h3 data-i18n="flow4Title">4. ëŒ€í™”/ë§Œë‚¨</h3><p class="muted" data-i18n="flow4Desc">ìë™ ë²ˆì—­ ì±„íŒ…Â·ë§Œë‚¨ ì¡°ìœ¨.</p></div>
        </div>
      </div>
    </section>

    <!-- AUTH -->
    <section id="auth" style="display:none">
      <div id="loginBox" class="card">
        <h2 style="margin-top:0" data-i18n="loginTitle">ë¡œê·¸ì¸</h2>
        <div class="input-row"><label data-i18n="emailLabel">ì´ë©”ì¼</label><input id="li_email" type="email" data-i18n-placeholder="emailPH" required></div>
        <div class="input-row"><label data-i18n="pwLabel">ë¹„ë°€ë²ˆí˜¸</label><input id="li_pw" type="password" data-i18n-placeholder="pwPH" required></div>
        <div class="row">
          <button class="btn primary" data-i18n="loginBtn" onclick="auth.login()">ë¡œê·¸ì¸</button>
        </div>
        <div id="li_msg" class="help"></div>
        <div class="divider"></div>
        <button class="btn ghost" data-i18n="signupLink" onclick="ui.showSignup()">íšŒì›ê°€ì…</button>
      </div>

      <div id="signupBox" class="card" style="display:none">
        <h2 style="margin-top:0" data-i18n="signupTitle">ê¸°ë³¸ ì •ë³´ ê¸°ì…</h2>
        <div class="help" data-i18n="signupHelp">ê°€ì…â†’ê¸°ë³¸ ì •ë³´â†’ë‚´ í”„ë¡œí•„â†’ì´ìƒí˜• í”„ë¡œí•„ ìˆœìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤. <b>ìì„¸íˆ ì…ë ¥í• ìˆ˜ë¡ ë§¤ì¹­ë  í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤.</b></div>
        <div class="row" style="justify-content:flex-end;margin-bottom:8px">
          <button class="btn ghost" data-i18n="backLogin" onclick="ui.showLogin()">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
        </div>
        <div class="input-row"><label class="req" data-i18n="emailLabel">ì´ë©”ì¼</label><input id="su_email" type="email" data-i18n-placeholder="emailPH" placeholder="you@example.com" required></div>
        <div class="input-row"><label class="req" data-i18n="nickLabel">ë‹‰ë„¤ì„</label><input id="su_nick" data-i18n-placeholder="nickPH" placeholder="ë³„ëª…" required minlength="2" maxlength="20"></div>
        <div class="input-row"><label class="req" data-i18n="pwLabel">ë¹„ë°€ë²ˆí˜¸</label><input id="su_pw" type="password" data-i18n-placeholder="pwPH" placeholder="8ì ì´ìƒ" required minlength="8"></div>
        <div class="divider"></div>
        <h3 data-i18n="verifyTitle">ë³¸ì¸ì¸ì¦(ëª¨ì˜)</h3>
        <div class="input-row"><label data-i18n="verifyMethod">ì—°ë½ìˆ˜ë‹¨</label>
          <select id="su_verify_type"><option value="sms" data-i18n-option="verifySMS">íœ´ëŒ€í°(SMS)</option><option value="email" data-i18n-option="verifyEmail">ì´ë©”ì¼</option></select>
        </div>
        <div class="input-row"><label data-i18n="contactLabel">ì—°ë½ì²˜</label><input id="su_verify_target" data-i18n-placeholder="contactPH" placeholder="010-0000-0000 / you@example.com"></div>
        <div class="row">
          <button class="btn ghost" data-i18n="sendCode" onclick="auth.sendCode()">ì¸ì¦ì½”ë“œ ì „ì†¡(ëª¨ì˜)</button>
          <input id="su_code" data-i18n-placeholder="codePH" placeholder="ì¸ì¦ì½”ë“œ 6ìë¦¬" style="width:160px">
          <button class="btn ghost" data-i18n="verifyBtn" onclick="auth.verifyCode()">ì¸ì¦ í™•ì¸</button>
        </div>
        <div id="su_verify_msg" class="help"></div>
        <div class="divider"></div>
        <h3 data-i18n="basicInfoTitle">ê¸°ë³¸ ì •ë³´</h3>
        <div class="input-row"><label class="req" data-i18n="genderLabel">ì„±ë³„</label>
          <select id="ob_gender"><option value="male" data-i18n-option="male">ë‚¨ì„±</option><option value="female" data-i18n-option="female">ì—¬ì„±</option></select>
        </div>
        <div class="input-row"><label class="req" data-i18n="birthLabel">ì¶œìƒë…„ë„</label><input id="ob_birth" type="number" min="1950" max="2010" data-i18n-placeholder="birthPH" placeholder="1998"></div>
        <div class="input-row"><label class="req" data-i18n="countryLabel">êµ­ê°€</label>
          <select id="ob_country"><option value="KR" data-i18n-option="kr">ëŒ€í•œë¯¼êµ­</option><option value="JP" data-i18n-option="jp">ì¼ë³¸</option></select>
        </div>
        <div class="input-row">
          <label style="display:flex;align-items:center;gap:8px;align-self:flex-start">
            <input id="su_tos" type="checkbox">
            <span data-i18n="tosAgree">ì„œë¹„ìŠ¤ ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤</span>
          </label>
        </div>
        <div class="row sticky-cta"><button class="btn primary" data-i18n="signupBtn" onclick="auth.signup()">ê³„ì • ìƒì„±</button></div>
      </div>
    </section>

    <!-- PROFILE (SELF INFO) -->
    <section id="profile" class="card" style="display:none">
      <h2 data-i18n="profileTitle">ë‚´ í”„ë¡œí•„</h2>
      <div class="help" data-i18n="detailHelp"><b>ìì„¸íˆ ì…ë ¥í• ìˆ˜ë¡ ë§¤ì¹­ë  í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤.</b></div>
      <div class="help" data-i18n="profilePrivacy">ì§€ê¸ˆ ì…ë ¥í•˜ê³  ìˆëŠ” ì •ë³´ë“¤ì€ ë§¤ì¹­ì—ë§Œ í™œìš©í•˜ë©° ìƒëŒ€ëŠ” ê¸°ë³¸ ì •ë³´ë§Œ ì—´ëŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë¡œì˜ ì •ë³´ì— ëŒ€í•´ì„œëŠ” ë§¤ì¹­ ì´í›„ ììœ ë¡­ê²Œ ëŒ€í™”ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ìš©ìì˜ ì •ë³´ëŠ” ê°œì¸ì •ë³´ë³´í˜¸ë²•ì— ì˜í•´ ë³´í˜¸ë©ë‹ˆë‹¤.</div>
      <div class="grid">
        <div class="sm-6 card">
          <div class="row">
            <img id="pf_avatar" class="avatar" 
     src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" 
     alt="avatar" />
            <div class="help" data-i18n="avatarHelp">ì •ë©´ ì¦ëª…ì‚¬ì§„ ê¶Œì¥. ë°ëª¨ì—ì„œëŠ” ë¡œì»¬ íŒŒì¼ë§Œ ë¯¸ë¦¬ë³´ê¸°.</div>
          </div>
          <div class="input-row"><label data-i18n="realnameLabel">ì´ë¦„(ì‹¤ëª…)</label><input id="pf_realname" data-i18n-placeholder="realnamePH" placeholder="í™ê¸¸ë™"></div>
          <div class="input-row"><label data-i18n="photoLabel">ì‚¬ì§„ ì—…ë¡œë“œ</label><input id="pf_photo" type="file" accept="image/*"></div>
          <div class="input-row"><label data-i18n="ageLabel">ë‚˜ì´</label><input id="pf_age" type="number" min="18" max="100" required></div>
          <div class="help" data-i18n="ageNote"></div>
          <div class="input-row"><label data-i18n="jobLabel">ì§ì—…</label><input id="pf_job" data-i18n-placeholder="jobPH" placeholder="ì§ì—…"></div>
          <div class="input-row"><label data-i18n="incomeLabel">ì—°ë´‰(ë§Œì›)</label><input id="pf_income" type="number" step="100" min="0" data-i18n-placeholder="incomePH" placeholder="ì˜ˆ: 4200" required></div>
          <div class="input-row"><label data-i18n="heightLabel">í‚¤(cm)</label><input id="pf_height" type="number" step="1" min="120" max="220" data-i18n-placeholder="heightPH" placeholder="ì˜ˆ: 175" required></div>
          <div class="input-row"><label data-i18n="bodyLabel">ì²´í˜•</label>
            <select id="pf_body"><option data-i18n-option="slender">ìŠ¬ë Œë”</option><option data-i18n-option="average">ë³´í†µ</option><option data-i18n-option="chubby">ì‚´ì§‘ ìˆìŒ</option></select>
          </div>
          <div class="input-row"><label data-i18n="mbtiLabel">MBTI</label>
            <select id="pf_mbti"></select>
          </div>
          <div class="input-row"><label data-i18n="religionLabel">ì¢…êµ</label>
            <select id="pf_religion"><option data-i18n-option="noReligion">ë¬´êµ</option><option data-i18n-option="christian">ê¸°ë…êµ</option><option data-i18n-option="catholic">ì²œì£¼êµ</option><option data-i18n-option="buddhist">ë¶ˆêµ</option><option data-i18n-option="etc">ê¸°íƒ€</option></select>
          </div>
          <div class="input-row"><label data-i18n="eduLabel">í•™ë ¥</label>
            <select id="pf_edu"><option data-i18n-option="highschool">ê³ ì¡¸</option><option data-i18n-option="college">ì „ë¬¸ëŒ€ì¡¸</option><option data-i18n-option="university">ëŒ€ì¡¸</option><option data-i18n-option="graduate">ëŒ€í•™ì› ì´ìƒ</option></select>
          </div>
          <div class="input-row"><label data-i18n="smokeLabel">í¡ì—°</label>
            <select id="pf_smoke"><option data-i18n-option="smokeNo">ë¹„í¡ì—°</option><option data-i18n-option="smokeSometimes">ê°€ë”</option><option data-i18n-option="smokeYes">í¡ì—°</option></select>
          </div>
          <div class="input-row"><label data-i18n="drinkLabel">ìŒì£¼</label>
            <select id="pf_drink"><option data-i18n-option="drinkNo">ë¹„ìŒì£¼</option><option data-i18n-option="drinkSometimes">ê°€ë”</option><option data-i18n-option="drinkOften">ìì£¼</option></select>
          </div>
          <div class="input-row"><label data-i18n="childLabel">ìë…€ ê³„íš</label>
            <select id="pf_child"><option data-i18n-option="childYes">ì›í•¨</option><option data-i18n-option="childMaybe">ì•„ì§ ë¯¸ì •</option><option data-i18n-option="childNo">ì›í•˜ì§€ ì•ŠìŒ</option></select>
          </div>
          <div class="input-row"><label data-i18n="hobbyLabel">ì·¨ë¯¸(ììœ )</label><input id="pf_hobby" data-i18n-placeholder="hobbyPH" placeholder="ë“±ì‚°, ì¹´í˜, ê²Œì„â€¦"></div>
          <div class="input-row"><label data-i18n="bioLabel">í•œë§ˆë”” ì†Œê°œ</label><input id="pf_bio" data-i18n-placeholder="bioPH" placeholder="ë³¸ì¸ì„ í•œë§ˆë””ë¡œâ€¦"></div>
          <button class="btn primary" data-i18n="save" onclick="data.saveProfile()">ì €ì¥</button>
        </div>
        <div class="sm-6 card">
          <h3 data-i18n="matrixTitle">ì„±ê²© ë§¤íŠ¸ë¦­ìŠ¤(ì¹´í…Œê³ ë¦¬ë³„ ìµœëŒ€ 3ê°œ)</h3>
          <div id="matrix"></div>
          <div class="divider"></div>
          <button class="btn ghost" data-i18n="clearSelection" onclick="matrix.clear()">ì„ íƒ ì´ˆê¸°í™”</button>
        </div>
      </div>
      <div class="sticky-cta row"><button class="btn primary" data-i18n="nextPrefs" onclick="ui.nextFromStep2()">ë‹¤ìŒ: ì´ìƒí˜• í”„ë¡œí•„</button></div>
    </section>

    <!-- PREFERENCES (IDEAL TYPE) -->
    <section id="prefs" class="card" style="display:none">
      <h2 data-i18n="prefsTitle">ì´ìƒí˜• í”„ë¡œí•„</h2>
      <div class="help" data-i18n="detailHelp"><b>ìì„¸íˆ ì…ë ¥í• ìˆ˜ë¡ ë§¤ì¹­ë  í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤.</b></div>
      <div class="grid">
        <div class="sm-6 card">
          <div class="input-row"><label data-i18n="prefAgeLabel">ë‚˜ì´ ì„ í˜¸</label>
            <select id="pr_age_type"><option data-i18n-option="sameAge">ë™ê°‘</option><option data-i18n-option="younger">ì—°í•˜</option><option data-i18n-option="older">ì—°ìƒ</option></select>
          </div>
          <div class="row">
            <input id="pr_age_min" type="number" style="width:100px" data-i18n-placeholder="minPH" placeholder="ìµœì†Œ">
            <input id="pr_age_max" type="number" style="width:100px" data-i18n-placeholder="maxPH" placeholder="ìµœëŒ€">
          </div>
          <div class="help" data-i18n="prefAgeHelp"></div>
          <div class="input-row"><label data-i18n="incomeMin">ì—°ë´‰ ìµœì†Œ(ë§Œì›)</label><input id="pr_income_min" type="number" step="100"></div>
          <div class="input-row"><label data-i18n="heightRange">í‚¤ ë²”ìœ„(cm)</label>
            <div class="row"><input id="pr_height_min" type="number" style="width:100px" data-i18n-placeholder="minPH" placeholder="ìµœì†Œ"><input id="pr_height_max" type="number" style="width:100px" data-i18n-placeholder="maxPH" placeholder="ìµœëŒ€"></div>
          </div>
          <div class="input-row"><label data-i18n="bodyLabel">ì²´í˜•</label>
            <select id="pr_body"><option data-i18n-option="any">ë¬´ê´€</option><option data-i18n-option="slender">ìŠ¬ë Œë”</option><option data-i18n-option="average">ë³´í†µ</option><option data-i18n-option="chubby">ì‚´ì§‘ ìˆìŒ</option></select>
          </div>
          <div class="input-row"><label data-i18n="mbtiLabel">MBTI</label>
            <select id="pr_mbti"><option data-i18n-option="any">ë¬´ê´€</option></select>
          </div>
          <div class="input-row"><label data-i18n="prefHobbyLabel">ì·¨ë¯¸(í¬ë§)</label><input id="pr_hobby" data-i18n-placeholder="prefHobbyPH" placeholder="ìƒëŒ€ ì·¨ë¯¸ í¬ë§"></div>
        </div>
        <div class="sm-6 card">
          <h3 data-i18n="prefMatrixTitle">ì„±ê²© ì„ í˜¸(ì¹´í…Œê³ ë¦¬ë³„ 3ê°œ)</h3>
          <div id="matrixPref"></div>
          <label class="row" style="margin-top:8px"><input id="pr_deal" type="checkbox"> <span data-i18n="dealbreaker">ì„ íƒ ì¡°ê±´ì„ í•„ìˆ˜(Dealbreaker)ë¡œ ì ìš©</span></label>
          <div class="divider"></div>
          <button class="btn ghost" data-i18n="clearSelection" onclick="matrixPref.clear()">ì„ íƒ ì´ˆê¸°í™”</button>
        </div>
      </div>
      <div class="sticky-cta row"><button class="btn primary" data-i18n="save" onclick="data.savePrefs()">ì €ì¥</button></div>
    </section>

    <!-- MATCHING -->
    <section id="match" class="card" style="display:none">
      <h2 data-i18n="matchTitle">5. ë§¤ì¹­</h2>
      <div class="help" data-i18n="matchHelp">ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ AI ì ìˆ˜(ëª¨ì˜)ë¡œ ìƒìœ„ í›„ë³´ë¥¼ ê³ ë¥´ê³ , ë§¤ë‹ˆì € ìµœì¢… ì„ íƒì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.</div>
      <div class="row" style="margin:8px 0">
        <button class="btn primary" data-i18n="matchRequest" onclick="engine.match()">ë§¤ì¹­ ì‹ ì²­</button>
        <span id="match_msg" class="help"></span>
      </div>
      <div id="match_results" class="grid"></div>
    </section>

    <!-- CHAT -->
    <section id="chat" class="card" style="display:none">
      <h2 data-i18n="chatTitle">6. ëŒ€í™” + ìë™ ë²ˆì—­(ëª¨ì˜)</h2>
      <div class="help" data-i18n="chatHelp">ì‹¤ì„œë¹„ìŠ¤ì—ì„œëŠ” ë²ˆì—­ API(Google/DeepL ë“±) ì—°ë™. ë°ëª¨ëŠ” ì–¸ì–´ ê°ì§€/ë²ˆì—­ì„ <b>í‰ë‚´</b>ëƒ…ë‹ˆë‹¤.</div>
      <div class="grid">
        <div class="sm-8 card">
          <div id="chat_log" style="height:260px;overflow:auto;border:1px solid var(--border);border-radius:12px;padding:8px;background:#fff"></div>
          <div class="row" style="margin-top:8px">
            <input id="chat_input" data-i18n-placeholder="chatPlaceholder" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥â€¦" style="flex:1">
            <button class="btn primary" data-i18n="send" onclick="chat.send()">ë³´ë‚´ê¸°</button>
            <label class="row" style="align-items:center;gap:6px;margin-left:8px">
              <input id="enter_send" type="checkbox" checked> <span data-i18n="enterSend">ì—”í„°ë¡œ ì „ì†¡</span>
            </label>
          </div>
        </div>
        <div class="sm-4 card">
          <h3 data-i18n="meetingTitle">7. ë§Œë‚¨ ì‹ ì²­</h3>
          <p class="help" data-i18n="meetingHelp">ì–‘ì¸¡ì´ ëª¨ë‘ ë™ì˜í•˜ë©´ ì˜¤í”„ë¼ì¸/ì˜¨ë¼ì¸(ZOOM) ì¤‘ ì„ íƒí•˜ì—¬ ìŠ¤ì¼€ì¤„ ì¡°ìœ¨.</p>
          <div class="row">
            <button class="btn ghost" data-i18n="meetOffline" onclick="chat.requestMeet('offline')">ì˜¤í”„ë¼ì¸ ë§Œë‚¨ ì‹ ì²­</button>
            <button class="btn ghost" data-i18n="meetOnline" onclick="chat.requestMeet('online')">ZOOM ë§Œë‚¨ ì‹ ì²­</button>
          </div>
          <div id="meet_status" class="help" style="margin-top:8px"></div>
        </div>
      </div>
    </section>
  </main>

  <div id="toast" class="toast"></div>

  <!-- Modal: ë¡œê·¸ì¸ í•„ìš” -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="inner" tabindex="-1">
      <h3 id="modalTitle" data-i18n="modalTitle">ë¡œê·¸ì¸ ì´í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤</h3>
      <p class="help" data-i18n="modalHelp">ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ë˜ëŠ” ì‹ ê·œ ê°€ì… í›„ ì´ìš©í•˜ì„¸ìš”.</p>
      <div class="row" style="margin-top:8px">
        <button class="btn primary" data-i18n="modalLogin" onclick="ui.openAuth();ui.hideModal()">ë¡œê·¸ì¸ í•˜ëŸ¬ ê°€ê¸°</button>
        <button class="btn ghost" data-i18n="modalClose" onclick="ui.hideModal()">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <footer>
    <div class="foot-wrap">
      <span class="muted">Â© 2025 AiAi</span>
      <span class="muted">ï½œ</span>
      <a href="#home" class="muted" data-i18n="footHome" onclick="event.preventDefault(); ui.go('home');">í™ˆ</a>
      <span class="muted">ï½œ</span>
      <a href="#auth" class="muted" data-i18n="footStart" onclick="event.preventDefault(); ui.openAuth();">ì‹œì‘í•˜ê¸°</a>
    </div>
  </footer>

  <script>
    // ---- Utilities ----
    const $ = sel => document.querySelector(sel);
    const el = (tag, attrs={}, children=[])=>{const n=document.createElement(tag);Object.entries(attrs).forEach(([k,v])=>{if(k==='class') n.className=v; else if(k==='html') n.innerHTML=v; else if(k==='style') n.setAttribute('style',v); else n.setAttribute(k,v)});children.forEach(c=>n.appendChild(c));return n};
    const toast=(msg)=>{const t=$('#toast');t.textContent=msg;t.style.display='block';setTimeout(()=>t.style.display='none',1800)};
    const store={get:(k,d)=>{try{return JSON.parse(localStorage.getItem(k))??d}catch(e){return d}},set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)),del:(k)=>localStorage.removeItem(k)};
    const bindEnter=(sel,fn)=>{document.querySelectorAll(sel).forEach(el=>el.addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault();fn();}}));};

    // ---- Supabase realtime helpers ----
    async function getMe(){
      const { data } = await sb.auth.getUser();
      return data.user || null;
    }

    async function fetchProfile(userId){
      const { data, error } = await sb.from('profiles').select('nickname, avatar_url').eq('user_id', userId).maybeSingle();
      if(error) throw error;
      return data;
    }

    function subscribeMyMatches(onChange){
      const ch = sb.channel('matches-live');
      ch.on('postgres_changes',{event:'*',schema:'public',table:'matches',filter:`seeker=eq.${window.__CURRENT_UID__}`}, payload=>onChange(payload.new,payload));
      ch.on('postgres_changes',{event:'*',schema:'public',table:'matches',filter:`partner=eq.${window.__CURRENT_UID__}`}, payload=>onChange(payload.new,payload));
      ch.subscribe();
      return () => sb.removeChannel(ch);
    }

    async function onMatchChanged(row){
      if(!row) return;
      const me = window.__CURRENT_UID__;
      const partnerId = row.seeker===me ? row.partner : row.seeker;
      let nickname = '(ë‹‰ë„¤ì„ ì—†ìŒ)';
      try {
        const p = await fetchProfile(partnerId);
        window.__PARTNER_PROFILE__ = p;
        if(p?.nickname) nickname = p.nickname;
      } catch(err){
        console.error('í”„ë¡œí•„ ì¡°íšŒ ì‹¤íŒ¨', err);
      }
      const ok = confirm(`ë§¤ì¹­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ìƒëŒ€: ${nickname}`);
      if(ok){
        try {
          const conv = await ensureConversation(partnerId);
          window.__CURRENT_CONV_ID__ = conv.id;
          await enterChat(conv.id);
          ui.go('chat');
        } catch(err){
          console.error('ëŒ€í™”ë°© ì¤€ë¹„ ì‹¤íŒ¨', err);
        }
      }
    }

    async function ensureConversation(partnerId){
      const me = window.__CURRENT_UID__;
      const { data: existing } = await sb.from('conversations')
        .select('*')
        .or(`and(user_a.eq.${me},user_b.eq.${partnerId}),and(user_a.eq.${partnerId},user_b.eq.${me})`)
        .limit(1);
      if(existing && existing.length) return existing[0];
      const { data, error } = await sb.from('conversations')
        .insert({ user_a: me, user_b: partnerId }).select().single();
      if(error) throw error;
      return data;
    }

    let stopMatchesSub=null;
    const afterSignInHook = async (user) => {
      if(!sb) return;
      const me = user || await getMe();
      window.__CURRENT_UID__ = me?.id || null;
      if(!window.__CURRENT_UID__) return;
      if(stopMatchesSub){ stopMatchesSub(); }
      try{
        const prof = await fetchProfile(window.__CURRENT_UID__);
        if(prof) store.set('my_profile', prof);
      }catch(e){ console.error(e); }
      ui.badge();
      stopMatchesSub = subscribeMyMatches(onMatchChanged);
      try{
        const { data: rows } = await sb
          .from('matches')
          .select('*')
          .or(`seeker.eq.${window.__CURRENT_UID__},partner.eq.${window.__CURRENT_UID__}`)
          .limit(1);
        if(rows && rows.length){
          await onMatchChanged(rows[0]);
        }
      }catch(e){ console.error(e); }
    };

    const beforeSignOutHook = async () => {
      if(stopMatchesSub){ stopMatchesSub(); stopMatchesSub=null; }
      store.del('my_profile');
      window.__PARTNER_PROFILE__ = null;
      window.__CURRENT_UID__ = null;
    };

    async function sendMessage(conv_id,text,lang='ko'){
      const me=window.__CURRENT_UID__;
      const { error } = await sb.from('messages').insert({ conv_id, sender:me, text, lang });
      if(error) console.error('ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:', error);
    }

    function subscribeMessages(conv_id,onNewMsg){
      const ch = sb.channel('chat-'+conv_id);
      ch.on('postgres_changes',{event:'INSERT',schema:'public',table:'messages',filter:`conv_id=eq.${conv_id}`}, payload=>onNewMsg(payload.new));
      ch.subscribe();
      return () => sb.removeChannel(ch);
    }

    function renderMessage(msg){
      const host=$('#chat_log');
      if(!host) return;
      const mine = msg.sender===window.__CURRENT_UID__;
      const row=el('div',{class:'chat-row'});
      const avatar = mine ? store.get('my_profile')?.avatar_url : window.__PARTNER_PROFILE__?.avatar_url;
      if(!mine) row.appendChild(el('img',{class:'chat-avatar',src:avatar||''}));
      row.appendChild(el('div',{class:`bubble ${mine?'mine':'theirs'}`,html:escapeHtml(msg.text)}));
      if(mine) row.appendChild(el('img',{class:'chat-avatar',src:avatar||''}));
      host.appendChild(row);
      host.scrollTop=host.scrollHeight;
    }

    let stopMsgSub=null;
    async function enterChat(conv_id){
      window.__CURRENT_CONV_ID__=conv_id;
      if(stopMsgSub){ stopMsgSub(); stopMsgSub=null; }
      stopMsgSub = subscribeMessages(conv_id, renderMessage);
      const { data } = await sb.from('messages').select('*').eq('conv_id', conv_id).order('created_at',{ascending:true});
      if(data) data.forEach(renderMessage);
    }

    // ---- I18n ----
    const messages={
      ko:{
        badgeLoggedOut:'ë¡œê·¸ì•„ì›ƒ ìƒíƒœ',badgeUnverified:'ì¸ì¦ í•„ìš”',badgeVerified:'ì¸ì¦ë¨',
        navHome:'í™ˆ',navLogin:'ë¡œê·¸ì¸',navProfile:'í”„ë¡œí•„',navMatch:'ë§¤ì¹­',navChat:'ëŒ€í™”',navLogout:'ë¡œê·¸ì•„ì›ƒ',
        heroTitle:'ê°„ë‹¨íˆ ì‹œì‘í•˜ëŠ” <b>ì§„ì§€í•œ ë§Œë‚¨</b>',heroSub:'AI 1ì°¨ ì ìˆ˜ + ë§¤ë‹ˆì € ìµœì¢… ë§¤ì¹­. <b>10ë¶„ ë‚´ ë§¤ì¹­</b>ì„ ì•½ì†í•˜ëŠ” í•œÂ·ì¼ ê²°í˜¼/êµì œ ì„œë¹„ìŠ¤.',start:'ì§€ê¸ˆ ì‹œì‘í•˜ê¸°',taglineTitle:'ì˜ˆë¹„ ì‹ ë¶€ë“¤ì´ ë‹¹ì‹ ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.',taglineDesc:'ë¬¸í™” êµë¥˜ì˜ í™œë°œí™”, í•­ê³µí¸ì˜ ë°œë‹¬, K-POPê³¼ ì• ë‹ˆë©”ì´ì…˜ ì¸ê¸° ë“±ìœ¼ë¡œ í•œì¼ ê²°í˜¼ ì„±ì‚¬ìœ¨ì´ ë¹ ë¥´ê²Œ ë†’ì•„ì§€ê³  ìˆìŠµë‹ˆë‹¤.',profileCtaMsg:'ë¨¼ì € í”„ë¡œí•„ì„ ì‘ì„±í•˜ì„¸ìš”',profileCtaBtn:'í”„ë¡œí•„ ì‘ì„±',
        featuresTitle:'AiAiì˜ ê°•ì ',feat1Title:'10ë¶„ ë‚´ ë§¤ì¹­',feat1Desc:'AI ìŠ¤ì½”ì–´ë§ í›„ ë§¤ë‹ˆì €ê°€ ìµœì¢… ì„ íƒ',
        feat2Title:'ìë™ ë²ˆì—­ ì±„íŒ…',feat2Desc:'KOâ‡„JA ì‹¤ì‹œê°„ ëŒ€í™”ë¡œ<br>ìƒëŒ€ì˜ í˜¸ê°ì„ ë¨¼ì € í™•ì¸í•˜ì„¸ìš”',
        feat3Title:'ì•ˆì „ ê²€ì¦',feat3Desc:'ë³¸ì¸ì¸ì¦ + ìš´ì˜ì ê²€ìˆ˜',
        feat4Title:'ì •êµí•œ ì´ìƒí˜•',feat4Desc:'ì„±ê²© ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ìì‹ ê³¼<br>ê°€ì¥ ì˜ ë§ëŠ” ì‚¬ëŒì„ ì°¾ì•„ë³´ì„¸ìš”',
        feat5Title:'í•œÂ·ì¼ êµ­ì œ ê²°í˜¼ ì§€ì›',feat5Desc:'ê²°í˜¼ ê´€ë ¨ ë²•ë¥ /ì„œë¥˜,<br>ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”',
        feat6Title:'ë§Œë‚¨ ìŠ¤ì¼€ì¤„ë§',feat6Desc:'ì˜¤í”„ë¼ì¸/ZOOM ì¼ì • ì¡°ìœ¨',
        whyTitle:'ì™œ AiAiì¸ê°€ìš”?',
        why1Title:'â‘  10ë¶„ ë‚´ ë§¤ì¹­',why1Desc:'AI ì ìˆ˜ë¡œ ìƒìœ„ í›„ë³´ ì„ ë³„ í›„ ë§¤ë‹ˆì €ê°€ ìµœì¢… ì„ íƒ.',
        why2Title:'â‘¡ ë²ˆì—­ ê±±ì • ë',why2Desc:'ëŒ€í™”ì°½ì—ì„œ ìë™ ë²ˆì—­(ëª¨ì˜)ë¡œ ì–¸ì–´ ì¥ë²½ ìµœì†Œí™”.',
        why3Title:'â‘¢ ì•ˆì‹¬ ì„œë¹„ìŠ¤',why3Desc:'ë³¸ì¸ì¸ì¦ê³¼ ìš´ì˜ì ê²€ìˆ˜ë¡œ ìœ ë ¹ ê³„ì •/ë¦¬ìŠ¤í¬ ê°ì†Œ.',
        flowTitle:'ì´ìš© ìˆœì„œ',
        flow1Title:'1. ê°€ì…/ì¸ì¦',flow1Desc:'ì´ë©”ì¼Â·ë¹„ë²ˆ ì…ë ¥ í›„ ì¸ì¦.',
        flow2Title:'2. ì •ë³´ ê¸°ì…',flow2Desc:'ê¸°ë³¸Â·ë‚´ í”„ë¡œí•„Â·ì´ìƒí˜• í”„ë¡œí•„ 3ë‹¨ê³„.',
        flow3Title:'3. ë§¤ì¹­ ì‹ ì²­',flow3Desc:'í›„ë³´ 5ëª… ì¶”ì²œ â†’ ì„ íƒ.',
        flow4Title:'4. ëŒ€í™”/ë§Œë‚¨',flow4Desc:'ìë™ ë²ˆì—­ ì±„íŒ…Â·ë§Œë‚¨ ì¡°ìœ¨.',
        modalTitle:'ë¡œê·¸ì¸ ì´í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤',
        modalHelp:'ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ë˜ëŠ” ì‹ ê·œ ê°€ì… í›„ ì´ìš©í•˜ì„¸ìš”.',
        modalLogin:'ë¡œê·¸ì¸ í•˜ëŸ¬ ê°€ê¸°',
        modalClose:'ë‹«ê¸°',
        footHome:'í™ˆ',footStart:'ì‹œì‘í•˜ê¸°',
        loginTitle:'ë¡œê·¸ì¸',emailLabel:'ì´ë©”ì¼',pwLabel:'ë¹„ë°€ë²ˆí˜¸',loginBtn:'ë¡œê·¸ì¸',signupLink:'íšŒì›ê°€ì…',
        signupTitle:'ê¸°ë³¸ ì •ë³´ ê¸°ì…',signupHelp:'ê°€ì…â†’ê¸°ë³¸ ì •ë³´â†’ë‚´ í”„ë¡œí•„â†’ì´ìƒí˜• í”„ë¡œí•„ ìˆœìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤. <b>ìì„¸íˆ ì…ë ¥í• ìˆ˜ë¡ ë§¤ì¹­ë  í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤.</b>',nickLabel:'ë‹‰ë„¤ì„',nickPH:'ë³„ëª…',emailPH:'you@example.com',pwPH:'8ì ì´ìƒ',tosLabel:'ì•½ê´€ë™ì˜',tosAgree:'ì„œë¹„ìŠ¤ ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤',signupBtn:'ê³„ì • ìƒì„±',verifyTitle:'ë³¸ì¸ì¸ì¦(ëª¨ì˜)',verifyMethod:'ì—°ë½ìˆ˜ë‹¨',verifySMS:'íœ´ëŒ€í°(SMS)',verifyEmail:'ì´ë©”ì¼',contactLabel:'ì—°ë½ì²˜',contactPH:'010-0000-0000 / you@example.com',sendCode:'ì¸ì¦ì½”ë“œ ì „ì†¡(ëª¨ì˜)',codePH:'ì¸ì¦ì½”ë“œ 6ìë¦¬',verifyBtn:'ì¸ì¦ í™•ì¸',basicInfoTitle:'ê¸°ë³¸ ì •ë³´',genderLabel:'ì„±ë³„',male:'ë‚¨ì„±',female:'ì—¬ì„±',birthLabel:'ì¶œìƒë…„ë„',birthPH:'1998',countryLabel:'êµ­ê°€',kr:'ëŒ€í•œë¯¼êµ­',jp:'ì¼ë³¸',nextProfile:'ë‹¤ìŒ: ë‚´ í”„ë¡œí•„',backLogin:'ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°',
        profileTitle:'ë‚´ í”„ë¡œí•„',detailHelp:'<b>ìì„¸íˆ ì…ë ¥í• ìˆ˜ë¡ ë§¤ì¹­ë  í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤.</b>',profilePrivacy:'ì§€ê¸ˆ ì…ë ¥í•˜ê³  ìˆëŠ” ì •ë³´ë“¤ì€ ë§¤ì¹­ì—ë§Œ í™œìš©í•˜ë©° ìƒëŒ€ëŠ” ê¸°ë³¸ ì •ë³´ë§Œ ì—´ëŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë¡œì˜ ì •ë³´ì— ëŒ€í•´ì„œëŠ” ë§¤ì¹­ ì´í›„ ììœ ë¡­ê²Œ ëŒ€í™”ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ìš©ìì˜ ì •ë³´ëŠ” ê°œì¸ì •ë³´ë³´í˜¸ë²•ì— ì˜í•´ ë³´í˜¸ë©ë‹ˆë‹¤.',avatarHelp:'ì •ë©´ ì¦ëª…ì‚¬ì§„ ê¶Œì¥. ë°ëª¨ì—ì„œëŠ” ë¡œì»¬ íŒŒì¼ë§Œ ë¯¸ë¦¬ë³´ê¸°.',realnameLabel:'ì´ë¦„(ì‹¤ëª…)',realnamePH:'í™ê¸¸ë™',photoLabel:'ì‚¬ì§„ ì—…ë¡œë“œ',ageLabel:'ë‚˜ì´',jobLabel:'ì§ì—…',jobPH:'ì§ì—…',incomeLabel:'ì—°ë´‰(ë§Œì›)',incomePH:'ì˜ˆ: 4200',heightLabel:'í‚¤(cm)',heightPH:'ì˜ˆ: 175',bodyLabel:'ì²´í˜•',slender:'ìŠ¬ë Œë”',average:'ë³´í†µ',chubby:'ì‚´ì§‘ ìˆìŒ',mbtiLabel:'MBTI',religionLabel:'ì¢…êµ',noReligion:'ë¬´êµ',christian:'ê¸°ë…êµ',catholic:'ì²œì£¼êµ',buddhist:'ë¶ˆêµ',etc:'ê¸°íƒ€',eduLabel:'í•™ë ¥',highschool:'ê³ ì¡¸',college:'ì „ë¬¸ëŒ€ì¡¸',university:'ëŒ€ì¡¸',graduate:'ëŒ€í•™ì› ì´ìƒ',smokeLabel:'í¡ì—°',smokeNo:'ë¹„í¡ì—°',smokeSometimes:'ê°€ë”',smokeYes:'í¡ì—°',drinkLabel:'ìŒì£¼',drinkNo:'ë¹„ìŒì£¼',drinkSometimes:'ê°€ë”',drinkOften:'ìì£¼',childLabel:'ìë…€ ê³„íš',childYes:'ì›í•¨',childMaybe:'ì•„ì§ ë¯¸ì •',childNo:'ì›í•˜ì§€ ì•ŠìŒ',hobbyLabel:'ì·¨ë¯¸(ììœ )',hobbyPH:'ë“±ì‚°, ì¹´í˜, ê²Œì„â€¦',bioLabel:'í•œë§ˆë”” ì†Œê°œ',bioPH:'ë³¸ì¸ì„ í•œë§ˆë””ë¡œâ€¦',save:'ì €ì¥',matrixTitle:'ì„±ê²© ë§¤íŠ¸ë¦­ìŠ¤(ì¹´í…Œê³ ë¦¬ë³„ ìµœëŒ€ 3ê°œ)',clearSelection:'ì„ íƒ ì´ˆê¸°í™”',nextPrefs:'ë‹¤ìŒ: ì´ìƒí˜• í”„ë¡œí•„',
        prefsTitle:'ì´ìƒí˜• í”„ë¡œí•„',prefAgeLabel:'ë‚˜ì´ ì„ í˜¸',sameAge:'ë™ê°‘',younger:'ì—°í•˜',older:'ì—°ìƒ',minPH:'ìµœì†Œ',maxPH:'ìµœëŒ€',incomeMin:'ì—°ë´‰ ìµœì†Œ(ë§Œì›)',heightRange:'í‚¤ ë²”ìœ„(cm)',any:'ë¬´ê´€',prefHobbyLabel:'ì·¨ë¯¸(í¬ë§)',prefHobbyPH:'ìƒëŒ€ ì·¨ë¯¸ í¬ë§',prefMatrixTitle:'ì„±ê²© ì„ í˜¸(ì¹´í…Œê³ ë¦¬ë³„ 3ê°œ)',dealbreaker:'ì„ íƒ ì¡°ê±´ì„ í•„ìˆ˜(Dealbreaker)ë¡œ ì ìš©',
        matchTitle:'5. ë§¤ì¹­',matchHelp:'ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ AI ì ìˆ˜(ëª¨ì˜)ë¡œ ìƒìœ„ í›„ë³´ë¥¼ ê³ ë¥´ê³ , ë§¤ë‹ˆì € ìµœì¢… ì„ íƒì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.',matchRequest:'ë§¤ì¹­ ì‹ ì²­',
        chatTitle:'6. ëŒ€í™” + ìë™ ë²ˆì—­(ëª¨ì˜)',chatHelp:'ì‹¤ì„œë¹„ìŠ¤ì—ì„œëŠ” ë²ˆì—­ API(Google/DeepL ë“±) ì—°ë™. ë°ëª¨ëŠ” ì–¸ì–´ ê°ì§€/ë²ˆì—­ì„ <b>í‰ë‚´</b>ëƒ…ë‹ˆë‹¤.',chatPlaceholder:'ë©”ì‹œì§€ë¥¼ ì…ë ¥â€¦',send:'ë³´ë‚´ê¸°',enterSend:'ì—”í„°ë¡œ ì „ì†¡',meetingTitle:'7. ë§Œë‚¨ ì‹ ì²­',meetingHelp:'ì–‘ì¸¡ì´ ëª¨ë‘ ë™ì˜í•˜ë©´ ì˜¤í”„ë¼ì¸/ì˜¨ë¼ì¸(ZOOM) ì¤‘ ì„ íƒí•˜ì—¬ ìŠ¤ì¼€ì¤„ ì¡°ìœ¨.',meetOffline:'ì˜¤í”„ë¼ì¸ ë§Œë‚¨ ì‹ ì²­',meetOnline:'ZOOM ë§Œë‚¨ ì‹ ì²­',
        toastRequired:'í•„ìˆ˜ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”',toastEmailTaken:'ì´ë¯¸ ê°€ì…ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤',toastSignupDone:'ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤',alertSignupDone:'ì‚¬ìš©ì ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤',toastNeedLogin:'ë¨¼ì € ê°€ì…/ë¡œê·¸ì¸ í•˜ì„¸ìš”',toastSendCode:'ì¸ì¦ì½”ë“œ ì „ì†¡(ëª¨ì˜)',toastNeedCode:'ì½”ë“œ ì „ì†¡ í›„ ì‹œë„í•˜ì„¸ìš”',toastVerifyDone:'ë³¸ì¸ì¸ì¦ ì™„ë£Œ',alertVerifyDone:'ì‚¬ìš©ì ë³¸ì¸ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ë” ë§ì€ ê¸°ëŠ¥ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',toastCodeWrong:'ì½”ë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤',loginFail:'ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”',loginSuccess:'ë¡œê·¸ì¸ ì„±ê³µ',toastLogin:'ë¡œê·¸ì¸',toastLogout:'ë¡œê·¸ì•„ì›ƒ',toastBasicInfo:'ê¸°ë³¸ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”',toastProfileIncomplete:'ë‚´ í”„ë¡œí•„ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”',toastSelectMBTI:'MBTIë¥¼ ì„ íƒí•˜ì„¸ìš”',toastLoginNeeded:'ë¡œê·¸ì¸ í•„ìš”',toastProfileSaved:'í”„ë¡œí•„ ì €ì¥ ì™„ë£Œ',alertProfileSaved:'í”„ë¡œí•„ ì €ì¥ ì™„ë£Œ',toastAgeRange:'ë‚˜ì´ ë²”ìœ„ë¥¼ ì…ë ¥í•˜ì„¸ìš”',toastPrefsSaved:'ì´ìƒí˜• ì €ì¥ ì™„ë£Œ',toastNeedProfileSave:'í”„ë¡œí•„/ì´ìƒí˜•ì„ ë¨¼ì € ì €ì¥í•˜ì„¸ìš”',alertNeedProfile:'ë¨¼ì € í”„ë¡œí•„ ì‘ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤',meetOfflineStatus:'ì˜¤í”„ë¼ì¸ ë§Œë‚¨ ì‹ ì²­ ë³´ëƒˆìŠµë‹ˆë‹¤ (ëª¨ì˜)',meetOnlineStatus:'ZOOM ë§Œë‚¨ ì‹ ì²­ ë³´ëƒˆìŠµë‹ˆë‹¤ (ëª¨ì˜)',ageNote:'ë§Œ ë‚˜ì´ ê¸°ì¤€ì…ë‹ˆë‹¤.',prefAgeHelp:'ë‚˜ì´ ì°¨ì´ëŠ” ì–´ëŠ ì •ë„ê°€ ê´œì°®ìœ¼ì‹ ê°€ìš”? -1 +2ì™€ ê°™ì€ ì‹ìœ¼ë¡œ ì ì–´ ì£¼ì„¸ìš”',toastImageType:'ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œí•˜ì„¸ìš”',toastImageSize:'2MB ì´í•˜ ì´ë¯¸ì§€ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤'
      },
      ja:{
        badgeLoggedOut:'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆçŠ¶æ…‹',badgeUnverified:'èªè¨¼å¿…è¦',badgeVerified:'èªè¨¼æ¸ˆã¿',
        navHome:'ãƒ›ãƒ¼ãƒ ',navLogin:'ãƒ­ã‚°ã‚¤ãƒ³',navProfile:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«',navMatch:'ãƒãƒƒãƒãƒ³ã‚°',navChat:'ãƒãƒ£ãƒƒãƒˆ',navLogout:'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ',
        heroTitle:'æ‰‹è»½ã«å§‹ã‚ã‚‹ <b>çœŸå‰£ãªå‡ºä¼šã„</b>',heroSub:'AIã«ã‚ˆã‚‹ä¸€æ¬¡ã‚¹ã‚³ã‚¢ + ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æœ€çµ‚ãƒãƒƒãƒãƒ³ã‚°ã€‚<b>10åˆ†ä»¥å†…ã«ãƒãƒƒãƒãƒ³ã‚°</b>ã‚’ç´„æŸã™ã‚‹æ—¥éŸ“çµå©šãƒ»äº¤éš›ã‚µãƒ¼ãƒ“ã‚¹ã€‚',start:'ä»Šã™ãå§‹ã‚ã‚‹',taglineTitle:'èŠ±å«å€™è£œãŒã‚ãªãŸã‚’å¾…ã£ã¦ã„ã¾ã™ã€‚',taglineDesc:'æ–‡åŒ–äº¤æµã®æ´»ç™ºåŒ–ã‚„èˆªç©ºä¾¿ã®ç™ºé”ã€K-POPã‚„ã‚¢ãƒ‹ãƒ¡ã®äººæ°—ãªã©ã«ã‚ˆã‚Šã€æ—¥éŸ“ã®çµå©šæˆç«‹ç‡ã¯æ€¥é€Ÿã«é«˜ã¾ã£ã¦ã„ã¾ã™ã€‚',profileCtaMsg:'ã¾ãšãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',profileCtaBtn:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å…¥åŠ›',
        featuresTitle:'AiAiã®å¼·ã¿',feat1Title:'10åˆ†ä»¥å†…ãƒãƒƒãƒãƒ³ã‚°',feat1Desc:'AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°å¾Œã«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒæœ€çµ‚é¸æŠ',
        feat2Title:'è‡ªå‹•ç¿»è¨³ãƒãƒ£ãƒƒãƒˆ',feat2Desc:'éŸ“â‡„æ—¥ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¼šè©±ã§<br>ç›¸æ‰‹ã®å¥½æ„ã‚’å…ˆã«ç¢ºã‹ã‚ã¾ã—ã‚‡ã†',
        feat3Title:'å®‰å…¨ãªæ¤œè¨¼',feat3Desc:'æœ¬äººç¢ºèª + é‹å–¶ãƒã‚§ãƒƒã‚¯',
        feat4Title:'ç·»å¯†ãªç†æƒ³åƒ',feat4Desc:'æ€§æ ¼ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ã§è‡ªåˆ†ã«<br>æœ€ã‚‚åˆã†ç›¸æ‰‹ã‚’æ¢ã—ã¾ã—ã‚‡ã†',
        feat5Title:'æ—¥éŸ“å›½éš›çµå©šã‚µãƒãƒ¼ãƒˆ',feat5Desc:'çµå©šé–¢é€£ã®æ³•å¾‹ãƒ»æ›¸é¡ã‚‚<br>ãŠä»»ã›ãã ã•ã„',
        feat6Title:'å‡ºä¼šã„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°',feat6Desc:'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³/ZOOMæ—¥ç¨‹èª¿æ•´',
        whyTitle:'ãªãœAiAiãªã®ã‹?',
        why1Title:'â‘  10åˆ†ä»¥å†…ãƒãƒƒãƒãƒ³ã‚°',why1Desc:'AIã‚¹ã‚³ã‚¢ã§ä¸Šä½å€™è£œã‚’é¸åˆ¥ã—ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒæœ€çµ‚é¸æŠã€‚',
        why2Title:'â‘¡ ç¿»è¨³ã®å¿ƒé…ãªã—',why2Desc:'ãƒãƒ£ãƒƒãƒˆã§è‡ªå‹•ç¿»è¨³(ãƒ‡ãƒ¢)ã«ã‚ˆã‚Šè¨€èªã®å£ã‚’æœ€å°åŒ–ã€‚',
        why3Title:'â‘¢ å®‰å¿ƒã‚µãƒ¼ãƒ“ã‚¹',why3Desc:'æœ¬äººç¢ºèªã¨é‹å–¶ãƒã‚§ãƒƒã‚¯ã§ä¸æ­£ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ/ãƒªã‚¹ã‚¯æ¸›å°‘ã€‚',
        flowTitle:'åˆ©ç”¨æ‰‹é †',
        flow1Title:'1. ç™»éŒ²/èªè¨¼',flow1Desc:'ãƒ¡ãƒ¼ãƒ«ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›å¾Œã«èªè¨¼ã€‚',
        flow2Title:'2. æƒ…å ±å…¥åŠ›',flow2Desc:'åŸºæœ¬ãƒ»ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ»ç†æƒ³ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®3æ®µéšã€‚',
        flow3Title:'3. ãƒãƒƒãƒãƒ³ã‚°ç”³è«‹',flow3Desc:'å€™è£œ5äººã‚’æ¨è–¦â†’é¸æŠã€‚',
        flow4Title:'4. ãƒãƒ£ãƒƒãƒˆ/å‡ºä¼šã„',flow4Desc:'è‡ªå‹•ç¿»è¨³ãƒãƒ£ãƒƒãƒˆãƒ»å‡ºä¼šã„èª¿æ•´ã€‚',
        modalTitle:'ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«åˆ©ç”¨ã§ãã¾ã™',
        modalHelp:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã¾ãŸã¯æ–°è¦ç™»éŒ²å¾Œã«ã”åˆ©ç”¨ãã ã•ã„ã€‚',
        modalLogin:'ãƒ­ã‚°ã‚¤ãƒ³ã—ã«è¡Œã',
        modalClose:'é–‰ã˜ã‚‹',
        footHome:'ãƒ›ãƒ¼ãƒ ',footStart:'é–‹å§‹ã™ã‚‹',
        loginTitle:'ãƒ­ã‚°ã‚¤ãƒ³',emailLabel:'ãƒ¡ãƒ¼ãƒ«',pwLabel:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',loginBtn:'ãƒ­ã‚°ã‚¤ãƒ³',signupLink:'ä¼šå“¡ç™»éŒ²',
        signupTitle:'åŸºæœ¬æƒ…å ±å…¥åŠ›',signupHelp:'ç™»éŒ²â†’åŸºæœ¬æƒ…å ±â†’ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«â†’ç†æƒ³ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®é †ã«é€²ã¿ã¾ã™ã€‚<b>è©³ã—ãå…¥åŠ›ã™ã‚‹ã»ã©ãƒãƒƒãƒãƒ³ã‚°ç‡ãŒä¸ŠãŒã‚Šã¾ã™ã€‚</b>',nickLabel:'ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ',nickPH:'ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ',emailPH:'you@example.com',pwPH:'8æ–‡å­—ä»¥ä¸Š',tosLabel:'åˆ©ç”¨è¦ç´„',tosAgree:'åˆ©ç”¨è¦ç´„ã«åŒæ„ã—ã¾ã™',signupBtn:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ',verifyTitle:'æœ¬äººç¢ºèª(ãƒ‡ãƒ¢)',verifyMethod:'é€£çµ¡æ‰‹æ®µ',verifySMS:'æºå¸¯é›»è©±(SMS)',verifyEmail:'ãƒ¡ãƒ¼ãƒ«',contactLabel:'é€£çµ¡å…ˆ',contactPH:'010-0000-0000 / you@example.com',sendCode:'èªè¨¼ã‚³ãƒ¼ãƒ‰é€ä¿¡(ãƒ‡ãƒ¢)',codePH:'èªè¨¼ã‚³ãƒ¼ãƒ‰6æ¡',verifyBtn:'èªè¨¼ç¢ºèª',basicInfoTitle:'åŸºæœ¬æƒ…å ±',genderLabel:'æ€§åˆ¥',male:'ç”·æ€§',female:'å¥³æ€§',birthLabel:'ç”Ÿå¹´',birthPH:'1998',countryLabel:'å›½',kr:'éŸ“å›½',jp:'æ—¥æœ¬',nextProfile:'æ¬¡: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«',backLogin:'ãƒ­ã‚°ã‚¤ãƒ³ã¸æˆ»ã‚‹',
        profileTitle:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«',detailHelp:'<b>è©³ã—ãå…¥åŠ›ã™ã‚‹ã»ã©ãƒãƒƒãƒãƒ³ã‚°ç‡ãŒä¸ŠãŒã‚Šã¾ã™ã€‚</b>',profilePrivacy:'å…¥åŠ›ã•ã‚ŒãŸæƒ…å ±ã¯ãƒãƒƒãƒãƒ³ã‚°ã®ã¿ã«åˆ©ç”¨ã•ã‚Œã€ç›¸æ‰‹ã¯åŸºæœ¬æƒ…å ±ã®ã¿é–²è¦§ã§ãã¾ã™ã€‚è©³ã—ã„æƒ…å ±ã¯ãƒãƒƒãƒãƒ³ã‚°å¾Œã®ä¼šè©±ã§è‡ªç”±ã«å…±æœ‰ã§ãã¾ã™ã€‚åˆ©ç”¨è€…ã®æƒ…å ±ã¯å€‹äººæƒ…å ±ä¿è­·æ³•ã«ã‚ˆã£ã¦ä¿è­·ã•ã‚Œã¾ã™ã€‚',avatarHelp:'æ­£é¢ã®è¨¼æ˜å†™çœŸã‚’æ¨å¥¨ã€‚ãƒ‡ãƒ¢ã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€‚',realnameLabel:'æ°å',realnamePH:'å±±ç”°å¤ªéƒ',photoLabel:'å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',ageLabel:'å¹´é½¢',jobLabel:'è·æ¥­',jobPH:'è·æ¥­',incomeLabel:'å¹´å(ä¸‡å††)',incomePH:'ä¾‹: 4200',heightLabel:'èº«é•·(cm)',heightPH:'ä¾‹: 175',bodyLabel:'ä½“å‹',slender:'ã‚¹ãƒ¬ãƒ³ãƒ€ãƒ¼',average:'æ™®é€š',chubby:'ãµãã‚ˆã‹',mbtiLabel:'MBTI',religionLabel:'å®—æ•™',noReligion:'ç„¡å®—æ•™',christian:'ã‚­ãƒªã‚¹ãƒˆæ•™',catholic:'ã‚«ãƒˆãƒªãƒƒã‚¯',buddhist:'ä»æ•™',etc:'ãã®ä»–',eduLabel:'å­¦æ­´',highschool:'é«˜æ ¡å’',college:'çŸ­å¤§å’',university:'å¤§å­¦å’',graduate:'å¤§å­¦é™¢ä»¥ä¸Š',smokeLabel:'å–«ç…™',smokeNo:'éå–«ç…™',smokeSometimes:'æ™‚ã€…',smokeYes:'å–«ç…™',drinkLabel:'é£²é…’',drinkNo:'é£²ã¾ãªã„',drinkSometimes:'æ™‚ã€…',drinkOften:'ã‚ˆãé£²ã‚€',childLabel:'å­ã©ã‚‚è¨ˆç”»',childYes:'å¸Œæœ›ã™ã‚‹',childMaybe:'æœªå®š',childNo:'å¸Œæœ›ã—ãªã„',hobbyLabel:'è¶£å‘³',hobbyPH:'ç™»å±±ã€ã‚«ãƒ•ã‚§ã€ã‚²ãƒ¼ãƒ â€¦',bioLabel:'ã²ã¨è¨€ç´¹ä»‹',bioPH:'è‡ªå·±ç´¹ä»‹ã‚’ä¸€è¨€ã§â€¦',save:'ä¿å­˜',matrixTitle:'æ€§æ ¼ãƒãƒˆãƒªãƒƒã‚¯ã‚¹(å„ã‚«ãƒ†ã‚´ãƒªãƒ¼æœ€å¤§3ã¤)',clearSelection:'é¸æŠãƒªã‚»ãƒƒãƒˆ',nextPrefs:'æ¬¡: ç†æƒ³ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«',
        prefsTitle:'ç†æƒ³ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«',prefAgeLabel:'å¹´é½¢ã®å¸Œæœ›',sameAge:'åŒã„å¹´',younger:'å¹´ä¸‹',older:'å¹´ä¸Š',minPH:'æœ€å°',maxPH:'æœ€å¤§',incomeMin:'æœ€ä½å¹´å(ä¸‡å††)',heightRange:'èº«é•·ç¯„å›²(cm)',any:'æŒ‡å®šãªã—',prefHobbyLabel:'è¶£å‘³(å¸Œæœ›)',prefHobbyPH:'ç›¸æ‰‹ã«æœ›ã‚€è¶£å‘³',prefMatrixTitle:'æ€§æ ¼ã®å¥½ã¿(å„ã‚«ãƒ†ã‚´ãƒªãƒ¼3ã¤)',dealbreaker:'é¸æŠæ¡ä»¶ã‚’å¿…é ˆ(ãƒ‡ã‚£ãƒ¼ãƒ«ãƒ–ãƒ¬ã‚¤ã‚«ãƒ¼)ã¨ã—ã¦é©ç”¨',
        matchTitle:'5. ãƒãƒƒãƒãƒ³ã‚°',matchHelp:'ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨AIã‚¹ã‚³ã‚¢(ãƒ‡ãƒ¢)ã§ä¸Šä½å€™è£œã‚’é¸ã³ã€ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æœ€çµ‚é¸æŠã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚',matchRequest:'ãƒãƒƒãƒãƒ³ã‚°ç”³è«‹',
        chatTitle:'6. ãƒãƒ£ãƒƒãƒˆ + è‡ªå‹•ç¿»è¨³(ãƒ‡ãƒ¢)',chatHelp:'æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ç¿»è¨³API(Google/DeepLç­‰)ã‚’é€£æºã€‚ãƒ‡ãƒ¢ã§ã¯è¨€èªæ¤œå‡º/ç¿»è¨³ã‚’< b>æ“¬ä¼¼</b>çš„ã«è¡Œã„ã¾ã™ã€‚',chatPlaceholder:'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›â€¦',send:'é€ä¿¡',enterSend:'Enterã§é€ä¿¡',meetingTitle:'7. å‡ºä¼šã„ç”³è«‹',meetingHelp:'åŒæ–¹ãŒåŒæ„ã™ã‚‹ã¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³/ã‚ªãƒ³ãƒ©ã‚¤ãƒ³(ZOOM)ã‹ã‚‰æ—¥ç¨‹èª¿æ•´ã—ã¾ã™ã€‚',meetOffline:'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‡ºä¼šã„ç”³è«‹',meetOnline:'ZOOMå‡ºä¼šã„ç”³è«‹',
        toastRequired:'å¿…é ˆé …ç›®ã‚’ç¢ºèªã—ã¦ãã ã•ã„',toastEmailTaken:'æ—¢ã«ç™»éŒ²ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã§ã™',toastSignupDone:'ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ',alertSignupDone:'ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ',toastNeedLogin:'ã¾ãšç™»éŒ²/ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„',toastSendCode:'èªè¨¼ã‚³ãƒ¼ãƒ‰é€ä¿¡(ãƒ‡ãƒ¢)',toastNeedCode:'ã‚³ãƒ¼ãƒ‰é€ä¿¡å¾Œã«è©¦ã—ã¦ãã ã•ã„',toastVerifyDone:'æœ¬äººèªè¨¼å®Œäº†',alertVerifyDone:'æœ¬äººèªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸã€‚ã•ã‚‰ã«å¤šãã®æ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã¾ã™',toastCodeWrong:'ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“',loginFail:'ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„',loginSuccess:'ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ',toastLogin:'ãƒ­ã‚°ã‚¤ãƒ³',toastLogout:'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ',toastBasicInfo:'åŸºæœ¬æƒ…å ±ã‚’ã™ã¹ã¦å…¥åŠ›ã—ã¦ãã ã•ã„',toastProfileIncomplete:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ã™ã¹ã¦å…¥åŠ›ã—ã¦ãã ã•ã„',toastSelectMBTI:'MBTIã‚’é¸æŠã—ã¦ãã ã•ã„',toastLoginNeeded:'ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™',toastProfileSaved:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜å®Œäº†',alertProfileSaved:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜å®Œäº†',toastAgeRange:'å¹´é½¢ç¯„å›²ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',toastPrefsSaved:'ç†æƒ³ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜å®Œäº†',toastNeedProfileSave:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«/ç†æƒ³ã‚’å…ˆã«ä¿å­˜ã—ã¦ãã ã•ã„',alertNeedProfile:'ã¾ãšãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å…¥åŠ›ãŒå¿…è¦ã§ã™',meetOfflineStatus:'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‡ºä¼šã„ã‚’ç”³è«‹ã—ã¾ã—ãŸ(ãƒ‡ãƒ¢)',meetOnlineStatus:'ZOOMå‡ºä¼šã„ã‚’ç”³è«‹ã—ã¾ã—ãŸ(ãƒ‡ãƒ¢)',ageNote:'',prefAgeHelp:'å¹´é½¢å·®ã¯ã©ã®ç¨‹åº¦ãŒã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ -1 +2ã®ã‚ˆã†ã«è¨˜å…¥ã—ã¦ãã ã•ã„',toastImageType:'ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯èƒ½ã§ã™',toastImageSize:'2MBä»¥ä¸‹ã®ç”»åƒã®ã¿å¯èƒ½ã§ã™'
      }
    };
    const i18n={
      lang:'ko',
      set(l){
        this.lang=l;
        store.set('lang',l);
        const sel=$('#langSel'); if(sel) sel.value=l;
        document.documentElement.lang=l;
        document.querySelectorAll('[data-i18n]').forEach(el=>{
          const key=el.getAttribute('data-i18n');
          if(Object.prototype.hasOwnProperty.call(messages[l],key)) el.innerHTML=messages[l][key];
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(el=>{
          const key=el.getAttribute('data-i18n-placeholder');
          if(Object.prototype.hasOwnProperty.call(messages[l],key)) el.placeholder=messages[l][key];
        });
        document.querySelectorAll('[data-i18n-option]').forEach(el=>{
          const key=el.getAttribute('data-i18n-option');
          if(Object.prototype.hasOwnProperty.call(messages[l],key)) el.textContent=messages[l][key];
        });
        rebuildMatrices();
        ui.badge();
        const fh=document.querySelector('[data-i18n="footHome"]'); if(fh) fh.textContent=messages[l].footHome;
        const fs=document.querySelector('[data-i18n="footStart"]'); if(fs) fs.textContent=messages[l].footStart;
      },
      t(key){return messages[this.lang][key]||'';}
    };

    // ---- Auth (Supabase) ----
    const auth={
      async signup(){
        const email=$('#su_email').value?.trim();
        const nick=$('#su_nick').value?.trim();
        const pw=$('#su_pw').value;
        const tos=$('#su_tos').checked;
        const g=$('#ob_gender').value;
        const b=$('#ob_birth').value;
        const c=$('#ob_country').value;
        const vv=store.get('verify');
        if(!email||!nick||!pw||!tos){toast(i18n.t('toastRequired'));return;}
        if(!vv||!vv.ok||vv.email!==email){toast(i18n.t('toastNeedCode'));return;}
        if(!g||!b||!c){toast(i18n.t('toastBasicInfo'));return;}
        const { data, error } = await sb.auth.signUp({ email, password: pw });
        if(error){ toast(error.message); return; }
        store.set('session',email);
        store.set('last_email',email);
        store.set('last_pw',pw);
        try{
          await sb.from('profiles').upsert({ user_id:data.user.id, nickname:nick, gender:g, birth_year:+b, country:c });
        }catch(e){ console.error(e); }
        store.set('my_profile',{ nickname:nick });
        store.del('verify');
        ui.badge();
        ui.refreshNav();
        ui.homeCTA();
        await afterSignInHook(data.user);
        data.loadProfile();
        data.loadPrefs();
        ui.go('home');
        toast(i18n.t('toastSignupDone'));
        alert(i18n.t('alertSignupDone'));
      },
      sendCode(){
        const email=$('#su_email').value?.trim();
        if(!email){toast(i18n.t('toastRequired'));return;}
        const code=(Math.random()*900000+100000|0).toString();
        store.set('verify',{email,code,ts:Date.now(),ok:false});
        $('#su_verify_msg').textContent=`${i18n.t('sendCode')}: ${code}`;
        toast(i18n.t('toastSendCode'));
      },
      verifyCode(){
        const vv=store.get('verify');
        const code=$('#su_code').value?.trim();
        if(!vv){toast(i18n.t('toastNeedCode'));return;}
        if(code===vv.code){
          vv.ok=true;
          store.set('verify',vv);
          toast(i18n.t('toastVerifyDone'));
          $('#su_verify_msg').textContent=i18n.t('badgeVerified');
          alert(i18n.t('alertVerifyDone'));
        } else { toast(i18n.t('toastCodeWrong')); }
      },
      async login(){
        const email=$('#li_email').value?.trim();
        const pw=$('#li_pw').value;
        const { data, error } = await sb.auth.signInWithPassword({ email, password: pw });
        if(error){$('#li_msg').textContent=i18n.t('loginFail');return;}
        store.set('session',email);
        store.set('last_email',email);
        store.set('last_pw',pw);
        await afterSignInHook(data.user);
        $('#li_msg').textContent=i18n.t('loginSuccess');
        toast(i18n.t('toastLogin'));
        ui.refreshNav();
        ui.homeCTA();
        data.loadProfile();
        data.loadPrefs();
        ui.go('home');
      },
      async logout(){
        await sb.auth.signOut();
        const email=store.get('session');
        if(email){
          store.del('tmp_photo_'+email);
          store.del('chat_with');
          store.del('meet_req');
        }
        store.del('session');
        await beforeSignOutHook();
        ui.clearForms();
        toast(i18n.t('toastLogout'));
        ui.badge();
        ui.refreshNav();
        ui.homeCTA();
        ui.go('home');
      }
    };

    // ---- UI routing & guards ----
    const ui={
      go(id){
  document.querySelectorAll('main section[id]').forEach(s=>s.style.display='none');
  const el=document.getElementById(id); if(el){el.style.display='block'}
  const map={home:'nav-home',auth:'nav-login',profile:'nav-profile',match:'nav-match',chat:'nav-chat'};
  document.querySelectorAll('nav .navlink').forEach(a=>a.removeAttribute('aria-current'));
  const target=document.getElementById(map[id]); if(target) target.setAttribute('aria-current','page');
  window.scrollTo({top:0,behavior:'smooth'});
  if(id==='profile') data.loadProfile();
  if(id==='prefs') data.loadPrefs();
},
      goProtected(id){
        const email=store.get('session');
        if(!email){ui.showModal();return;}
        if((id==='match'||id==='chat') && !ui.hasProfile()){
          alert(i18n.t('alertNeedProfile'));
          ui.go('profile');
          return;
        }
        ui.go(id);
      },
      start(){
        const email=store.get('session');
        if(email){ui.goProtected('match');} else ui.openAuth();
      },
      openAuth(){ui.showLogin(); ui.go('auth');},
      showSignup(){
        $('#loginBox').style.display='none';
        $('#signupBox').style.display='block';
      },
      showLogin(){
        $('#signupBox').style.display='none';
        $('#loginBox').style.display='block';
      },
      badge(){
        const email=store.get('session');
        const badge=$('#userBadge');
        if(email){
        const prof=store.get('my_profile');
        const u=store.get('users',{})[email];
        const nick=prof?.nickname || prof?.nick || u?.nick || email;
          badge.textContent=`${nick}ë‹˜ ë°˜ê°‘ìŠµë‹ˆë‹¤!`;
          badge.className='badge good';
        } else {
          badge.textContent=i18n.t('badgeLoggedOut');
          badge.className='badge warn';
        }
      },
      refreshNav(){
        const logged=!!store.get('session');
        $('#nav-login').style.display=logged?'none':'inline-flex';
        $('#nav-logout').style.display=logged?'inline-flex':'none';
      },
      hasProfile(){
        const email=store.get('session');
        if(!email) return false;
        const p=store.get('profiles',{})[email];
        const pref=store.get('prefs',{})[email];
        return !!p && !!pref;
      },
      homeCTA(){
        const card=$('#profileCTA');
        if(!card) return;
        const show=store.get('session') && !ui.hasProfile();
        card.style.display=show?'block':'none';
      },
      logout(){auth.logout();},
      clearForms(){
        document.querySelectorAll('input').forEach(el=>{if(el.type==='checkbox'||el.type==='radio')el.checked=false; else el.value='';});
        document.querySelectorAll('select').forEach(el=>el.selectedIndex=0);
        $('#pf_avatar').src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';
        ['su_verify_msg','li_msg','match_msg','meet_status'].forEach(id=>{const e=document.getElementById(id); if(e) e.textContent='';});
        ['match_results','chat_log'].forEach(id=>{const e=document.getElementById(id); if(e) e.innerHTML='';});
      },
      showModal(){$('#modal').style.display='flex';},
      hideModal(){$('#modal').style.display='none';},
      nextFromStep2(){
        const need=['#pf_realname','#pf_age','#pf_income','#pf_height'];
        for(const sel of need){const v=$(sel).value?.trim(); if(!v){toast(i18n.t('toastProfileIncomplete'));return;}}
        const mb=$('#pf_mbti').value; if(!mb){toast(i18n.t('toastSelectMBTI'));return;}
        data.saveProfile(); ui.go('prefs');
      }
    };

    (()=>{
      const modal=document.getElementById('modal');
      const inner=modal?.querySelector('.inner');
      let lastFocused=null;
      function trap(e){
        if(e.key==='Tab'){
          const f=inner.querySelectorAll('button,[href],input,select,textarea,[tabindex]:not([tabindex="-1"])');
          const focusables=Array.from(f).filter(el=>!el.disabled && el.offsetParent!==null);
          if(!focusables.length) return;
          const first=focusables[0], last=focusables[focusables.length-1];
          if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }
          else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }
        } else if(e.key==='Escape'){
          ui.hideModal();
        }
      }
      const oldShow=ui.showModal, oldHide=ui.hideModal;
      ui.showModal=()=>{
        lastFocused=document.activeElement;
        modal.style.display='flex';
        inner.setAttribute('tabindex','-1');
        inner.focus();
        document.addEventListener('keydown',trap);
      };
      ui.hideModal=()=>{
        modal.style.display='none';
        document.removeEventListener('keydown',trap);
        if(lastFocused) lastFocused.focus();
      };
    })();

    // ---- MBTI options ----
    const MBTIs=["INTJ","INTP","ENTJ","ENTP","INFJ","INFP","ENFJ","ENFP","ISTJ","ISFJ","ESTJ","ESFJ","ISTP","ISFP","ESTP","ESFP"];
    function fillMBTI(){
      const sel=$('#pf_mbti');
      const sel2=$('#pr_mbti');
      MBTIs.forEach(x=>{const o=document.createElement('option');o.text=x;o.value=x;sel.appendChild(o)});
      MBTIs.forEach(x=>{const o=document.createElement('option');o.text=x;o.value=x;sel2.appendChild(o)});
    }

    // ---- Personality Matrix ----
    const MATRIX={
      "ì˜ì‚¬ì†Œí†µ":["ê³µê°ì„ ì˜í•˜ëŠ”","ì™¸í–¥ì ì¸","ë‚´ì„±ì ì¸","ë‹¤ì •í•œ","ì„¤ë“ë ¥ ìˆëŠ”","ì„¼ìŠ¤ ìˆëŠ”","ì• êµ ìˆëŠ”","ì˜ˆì˜ ë°”ë¥¸","ì¬ë¯¸ìˆëŠ”","ì¡°ë ¥ì ì¸"],
      "ìê¸°ê°œë°œ":["ê°œì¸ì ì¸","ê³ ìƒí•œ","ëŒ€ë‹´í•œ","ë¶€ì§€ëŸ°í•œ","ì•¼ì‹¬ë§Œë§Œí•œ","ì—´ì •ì ì¸","ì˜ì ì¸","ì¬ëŠ¥ ìˆëŠ”","ì „ë¬¸ì ì¸"],
      "ë¬¸ì œí•´ê²°":["ê°ê°ì ","ê°ê´€ì ì¸","ê²©ì •ì ì¸","ê²½ê³„ì‹¬ì´ ê°•í•œ","ê´€ì°°ë ¥ì´ ë›°ì–´ë‚œ","ê¸ì •ì ì¸","ê¸°ë°œí•œ","ëˆê¸° ìˆëŠ”","ëª¨í—˜ì‹¬ì´ ê°•í•œ"],
      "íŒ€ì›Œí¬":["ê°ì„±ì ","ê²¸ì†í•œ","ê³ ë§ˆì›Œí•  ì¤„ ì•„ëŠ”","ë†€ê¸° ì¢‹ì•„í•˜ëŠ”","ëŠê¸‹í•œ","ë‹¤ê°€ê°€ê¸° ì‰¬ìš´","ì‚¬ì‹¬ì´ ì—†ëŠ”","ìˆœì¢…ì ì¸","ìš°í˜¸ì ì¸","ìœ„íŠ¸ ìˆëŠ”"],
      "ë¦¬ë”ì‹­":["ê²°ë‹¨ë ¥ ìˆëŠ”","ê´€ëŒ€í•œ","ê´€ìš©ì ì¸","ë§¤ë ¥ì ì¸","ì˜ê°ì„ ì£¼ëŠ”","ì˜¨í™”í•œ","ìë¹„ë¡œìš´","ì˜ ë³´ì‚´í”¼ëŠ”","ì¤‘ì‹¬ì´ ì¡íŒ","ì¹¨ì°©í•œ"],
      "ì§ì—…ìœ¤ë¦¬":["ê±´ì „í•œ","ê¼¼ê¼¼í•œ","ë‚™ì²œì ì¸","ëª…ì˜ˆë¥¼ ì¤‘ì‹œí•˜ëŠ”","ë°˜ë“¯í•œ","ë°©ì–´ì ì¸","ë³´ìˆ˜ì ì¸","ì‚¬íšŒì  ì¸ì‹ì´ ë†’ì€","ì†Œë°•í•œ","ìˆœìˆ˜í•œ"]
    };

    const MATRIX_CAT_JA={
      "ì˜ì‚¬ì†Œí†µ":"ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
      "ìê¸°ê°œë°œ":"è‡ªå·±é–‹ç™º",
      "ë¬¸ì œí•´ê²°":"å•é¡Œè§£æ±º",
      "íŒ€ì›Œí¬":"ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯",
      "ë¦¬ë”ì‹­":"ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—",
      "ì§ì—…ìœ¤ë¦¬":"è·æ¥­å€«ç†"
    };

    const MATRIX_TAG_JA={
      "ì˜ì‚¬ì†Œí†µ":{
        "ê³µê°ì„ ì˜í•˜ëŠ”":"å…±æ„ŸåŠ›ãŒé«˜ã„",
        "ì™¸í–¥ì ì¸":"å¤–å‘çš„",
        "ë‚´ì„±ì ì¸":"å†…å‘çš„",
        "ë‹¤ì •í•œ":"å„ªã—ã„",
        "ì„¤ë“ë ¥ ìˆëŠ”":"èª¬å¾—åŠ›ã®ã‚ã‚‹",
        "ì„¼ìŠ¤ ìˆëŠ”":"ã‚»ãƒ³ã‚¹ãŒã‚ã‚‹",
        "ì• êµ ìˆëŠ”":"æ„›å¬ŒãŒã‚ã‚‹",
        "ì˜ˆì˜ ë°”ë¥¸":"ç¤¼å„€æ­£ã—ã„",
        "ì¬ë¯¸ìˆëŠ”":"é¢ç™½ã„",
        "ì¡°ë ¥ì ì¸":"ã‚µãƒãƒ¼ãƒˆä¸Šæ‰‹"
      },
      "ìê¸°ê°œë°œ":{
        "ê°œì¸ì ì¸":"å€‹äººçš„",
        "ê³ ìƒí•œ":"ä¸Šå“ãª",
        "ëŒ€ë‹´í•œ":"å¤§èƒ†ãª",
        "ë¶€ì§€ëŸ°í•œ":"å‹¤å‹‰ãª",
        "ì•¼ì‹¬ë§Œë§Œí•œ":"é‡å¿ƒçš„ãª",
        "ì—´ì •ì ì¸":"æƒ…ç†±çš„ãª",
        "ì˜ì ì¸":"ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«",
        "ì¬ëŠ¥ ìˆëŠ”":"æ‰èƒ½ãŒã‚ã‚‹",
        "ì „ë¬¸ì ì¸":"ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«"
      },
      "ë¬¸ì œí•´ê²°":{
        "ê°ê°ì ":"æ„Ÿè¦šçš„",
        "ê°ê´€ì ì¸":"å®¢è¦³çš„",
        "ê²©ì •ì ì¸":"æƒ…ç†±çš„",
        "ê²½ê³„ì‹¬ì´ ê°•í•œ":"è­¦æˆ’å¿ƒãŒå¼·ã„",
        "ê´€ì°°ë ¥ì´ ë›°ì–´ë‚œ":"è¦³å¯ŸåŠ›ãŒé«˜ã„",
        "ê¸ì •ì ì¸":"å‰å‘ã",
        "ê¸°ë°œí•œ":"æ–¬æ–°ãª",
        "ëˆê¸° ìˆëŠ”":"ç²˜ã‚Šå¼·ã„",
        "ëª¨í—˜ì‹¬ì´ ê°•í•œ":"å†’é™ºå¿ƒãŒå¼·ã„"
      },
      "íŒ€ì›Œí¬":{
        "ê°ì„±ì ":"æ„Ÿæƒ…è±Šã‹",
        "ê²¸ì†í•œ":"è¬™è™šãª",
        "ê³ ë§ˆì›Œí•  ì¤„ ì•„ëŠ”":"æ„Ÿè¬ã‚’å¿˜ã‚Œãªã„",
        "ë†€ê¸° ì¢‹ì•„í•˜ëŠ”":"éŠã³å¥½ã",
        "ëŠê¸‹í•œ":"ã®ã‚“ã³ã‚Šã—ãŸ",
        "ë‹¤ê°€ê°€ê¸° ì‰¬ìš´":"è¦ªã—ã¿ã‚„ã™ã„",
        "ì‚¬ì‹¬ì´ ì—†ëŠ”":"åˆ©ä»–çš„",
        "ìˆœì¢…ì ì¸":"å¾“é †ãª",
        "ìš°í˜¸ì ì¸":"å‹å¥½çš„",
        "ìœ„íŠ¸ ìˆëŠ”":"ã‚¦ã‚£ãƒƒãƒˆã«å¯Œã‚€"
      },
      "ë¦¬ë”ì‹­":{
        "ê²°ë‹¨ë ¥ ìˆëŠ”":"æ±ºæ–­åŠ›ãŒã‚ã‚‹",
        "ê´€ëŒ€í•œ":"å¯›å¤§ãª",
        "ê´€ìš©ì ì¸":"å¯›å®¹ãª",
        "ë§¤ë ¥ì ì¸":"é­…åŠ›çš„",
        "ì˜ê°ì„ ì£¼ëŠ”":"ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¸ãˆã‚‹",
        "ì˜¨í™”í•œ":"ç©ã‚„ã‹ãª",
        "ìë¹„ë¡œìš´":"æ…ˆæ‚²æ·±ã„",
        "ì˜ ë³´ì‚´í”¼ëŠ”":"é¢å€’è¦‹ãŒè‰¯ã„",
        "ì¤‘ì‹¬ì´ ì¡íŒ":"èŠ¯ãŒã‚ã‚‹",
        "ì¹¨ì°©í•œ":"è½ã¡ç€ã„ã¦ã„ã‚‹"
      },
      "ì§ì—…ìœ¤ë¦¬":{
        "ê±´ì „í•œ":"å¥å…¨ãª",
        "ê¼¼ê¼¼í•œ":"å‡ å¸³é¢ãª",
        "ë‚™ì²œì ì¸":"æ¥½å¤©çš„",
        "ëª…ì˜ˆë¥¼ ì¤‘ì‹œí•˜ëŠ”":"åèª‰ã‚’é‡ã‚“ã˜ã‚‹",
        "ë°˜ë“¯í•œ":"çœŸé¢ç›®ãª",
        "ë°©ì–´ì ì¸":"é˜²å¾¡çš„",
        "ë³´ìˆ˜ì ì¸":"ä¿å®ˆçš„",
        "ì‚¬íšŒì  ì¸ì‹ì´ ë†’ì€":"ç¤¾ä¼šçš„èªçŸ¥ãŒé«˜ã„",
        "ì†Œë°•í•œ":"ç´ æœ´ãª",
        "ìˆœìˆ˜í•œ":"ç´”ç²‹ãª"
      }
    };

    function buildMatrix(containerId,key){
      const wrap=$(containerId);
      wrap.innerHTML='';
      Object.entries(MATRIX).forEach(([cat,tags])=>{
        const catLabel=i18n.lang==='ja'?(MATRIX_CAT_JA[cat]||cat):cat;
        const box=el('div',{class:'card'});
        box.appendChild(el('h3',{html:catLabel}));
        const list=el('div',{class:'list'});
        tags.forEach(tag=>{
          const label=i18n.lang==='ja'?(MATRIX_TAG_JA[cat]?.[tag]||tag):tag;
          const id=`${key}:${cat}:${tag}`;
          const item=el('label',{class:'pill'});
          const txt=el('span',{html:label});
          const cb=el('input',{type:'checkbox',id});
          cb.addEventListener('change',()=>limitCategory(key,cat,3,id));
          item.appendChild(txt); item.appendChild(cb);
          list.appendChild(item);
        });
        box.appendChild(list);wrap.appendChild(box);
      });
    }
    const limitCategory=(key,cat,max,id)=>{
      const cbs=[...document.querySelectorAll(`input[id^="${key}:${cat}:"]`)];
      const selected=cbs.filter(x=>x.checked);
      if(selected.length>max){
        const last=document.getElementById(id);
        last.checked=false;
        const catLabel=i18n.lang==='ja'?(MATRIX_CAT_JA[cat]||cat):cat;
        toast(i18n.lang==='ja'?`${catLabel}ã¯æœ€å¤§${max}å€‹ã¾ã§`:`${catLabel}ëŠ” ìµœëŒ€ ${max}ê°œ`);
      }
    };
    const matrix={
      clear(){document.querySelectorAll('input[id^="self:"]').forEach(x=>x.checked=false);},
      read(){const out={};Object.keys(MATRIX).forEach(cat=>{out[cat]=[...document.querySelectorAll(`input[id^="self:${cat}:"]`)].filter(x=>x.checked).map(x=>x.id.split(':').pop())});return out;}
    };
    const matrixPref={
      clear(){document.querySelectorAll('input[id^="pref:"]').forEach(x=>x.checked=false);},
      read(){const out={};Object.keys(MATRIX).forEach(cat=>{out[cat]=[...document.querySelectorAll(`input[id^="pref:${cat}:"]`)].filter(x=>x.checked).map(x=>x.id.split(':').pop())});return out;}
    };

    function applyMatrixSelections(prefix,data){
      if(!data) return;
      Object.entries(data).forEach(([cat,tags])=>{
        (tags||[]).forEach(tag=>{
          const cb=document.getElementById(`${prefix}:${cat}:${tag}`);
          if(cb) cb.checked=true;
        });
      });
    }

    function rebuildMatrices(){
      const selfSel=matrix.read();
      const prefSel=matrixPref.read();
      buildMatrix('#matrix','self');
      buildMatrix('#matrixPref','pref');
      Object.entries(selfSel).forEach(([cat,tags])=>{tags.forEach(tag=>{const cb=document.getElementById(`self:${cat}:${tag}`); if(cb) cb.checked=true;});});
      Object.entries(prefSel).forEach(([cat,tags])=>{tags.forEach(tag=>{const cb=document.getElementById(`pref:${cat}:${tag}`); if(cb) cb.checked=true;});});
    }

    // ---- Data save/load ----
    const data={
      loadProfile(){
        const email=store.get('session');
        if(!email) return;
        const p=store.get('profiles',{})[email];
        if(!p) return;
        $('#pf_realname').value=p.realname||'';
        $('#pf_age').value=p.age||'';
        $('#pf_job').value=p.job||'';
        $('#pf_income').value=p.income||'';
        $('#pf_height').value=p.height||'';
        $('#pf_body').value=p.body||'';
        $('#pf_mbti').value=p.mbti||'';
        $('#pf_religion').value=p.religion||'';
        $('#pf_edu').value=p.edu||'';
        $('#pf_smoke').value=p.smoke||'';
        $('#pf_drink').value=p.drink||'';
        $('#pf_child').value=p.child||'';
        $('#pf_hobby').value=p.hobby||'';
        $('#pf_bio').value=p.bio||'';
        if(p.photo) $('#pf_avatar').src=p.photo;
        document.querySelectorAll('input[id^="self:"]').forEach(cb=>cb.checked=false);
        applyMatrixSelections('self',p.matrix);
        if(p.country) $('#ob_country').value=p.country;
        if(p.gender) $('#ob_gender').value=p.gender;
        if(p.birthYear) $('#ob_birth').value=p.birthYear;
      },
      loadPrefs(){
        const email=store.get('session');
        if(!email) return;
        const pref=store.get('prefs',{})[email];
        if(!pref) return;
        $('#pr_age_type').value=pref.ageType||'';
        $('#pr_age_min').value=pref.ageMin||'';
        $('#pr_age_max').value=pref.ageMax||'';
        $('#pr_income_min').value=pref.incomeMin||'';
        $('#pr_height_min').value=pref.heightMin||'';
        $('#pr_height_max').value=pref.heightMax||'';
        $('#pr_body').value=pref.body||'';
        $('#pr_mbti').value=pref.mbti||'ë¬´ê´€';
        $('#pr_hobby').value=pref.hobby||'';
        $('#pr_deal').checked=!!pref.deal;
        document.querySelectorAll('input[id^="pref:"]').forEach(cb=>cb.checked=false);
        applyMatrixSelections('pref',pref.matrix);
      },
      saveProfile(){
        const email=store.get('session');
        if(!email){toast(i18n.t('toastLoginNeeded'));return;}
        const profile={
          realname:$('#pf_realname').value,
          age:+$('#pf_age').value||null,
          job:$('#pf_job').value,
          income:+$('#pf_income').value||null,
          height:+$('#pf_height').value||null,
          body:$('#pf_body').value,
          mbti:$('#pf_mbti').value,
          religion:$('#pf_religion').value,
          edu:$('#pf_edu').value,
          smoke:$('#pf_smoke').value,
          drink:$('#pf_drink').value,
          child:$('#pf_child').value,
          hobby:$('#pf_hobby').value,
          bio:$('#pf_bio').value,
          matrix:matrix.read(),
          country:$('#ob_country')?.value,
          gender:$('#ob_gender')?.value,
          birthYear:+$('#ob_birth')?.value||null,
          photo:store.get('tmp_photo_'+email)
        };
        const db=store.get('profiles',{});
        db[email]=profile;
        store.set('profiles',db);
        toast(i18n.t('toastProfileSaved'));
        alert(i18n.t('alertProfileSaved'));
        ui.homeCTA();
      },
      savePrefs(){
        const email=store.get('session');
        if(!email){toast(i18n.t('toastLoginNeeded'));return;}
        const ageMin=$('#pr_age_min').value, ageMax=$('#pr_age_max').value;
        if(!ageMin||!ageMax){toast(i18n.t('toastAgeRange'));return;}
        const prefs={
          ageType:$('#pr_age_type').value,
          ageMin:+ageMin,
          ageMax:+ageMax,
          incomeMin:+($('#pr_income_min').value)||0,
          heightMin:+($('#pr_height_min').value)||null,
          heightMax:+($('#pr_height_max').value)||null,
          body:$('#pr_body').value,
          mbti:$('#pr_mbti').value,
          hobby:$('#pr_hobby').value,
          matrix:matrixPref.read(),
          deal:$('#pr_deal').checked
        };
        const db=store.get('prefs',{});
        db[email]=prefs;
        store.set('prefs',db);
        toast(i18n.t('toastPrefsSaved'));
        ui.homeCTA();
        ui.go('match');
      }
    };

    // photo preview
    window.addEventListener('change',e=>{
      if(e.target && e.target.id==='pf_photo'){
        const f=e.target.files?.[0];
        if(!f) return;
        if(!/^image\//.test(f.type)){ toast(i18n.t('toastImageType')); return; }
        if(f.size > 2*1024*1024){ toast(i18n.t('toastImageSize')); return; }
        const r=new FileReader();
        r.onload=()=>{store.set('tmp_photo_'+store.get('session'),r.result);$('#pf_avatar').src=r.result};
        r.readAsDataURL(f);
      }
    });

    // ---- Matching Engine (mock) ----
    const engine={
      score(me,pref,other){
        if(!other||!other.profile) return -1;
        const p=other.profile; let s=0;
        if(pref.heightMin && p.height>=pref.heightMin) s+=5;
        if(pref.heightMax && p.height<=pref.heightMax) s+=5;
        if(p.income && p.income>=(pref.incomeMin||0)) s+=6;
        if(pref.body && pref.body!=='ë¬´ê´€' && p.body===pref.body) s+=4;
        const comp={"INTJ":["ENFP","ENTP"],"ENFP":["INTJ","INFJ"],"ISTJ":["ENFP","ESFP"],"ENFJ":["INFP","ISFP"]};
        if(pref.mbti && pref.mbti!=='ë¬´ê´€'){
          if(p.mbti===pref.mbti) s+=4;
          if((comp[pref.mbti]||[]).includes(p.mbti)) s+=2;
        }
        const inter=(a,b)=>Object.keys(a).reduce((acc,k)=>acc+ a[k].filter(x=>b[k]?.includes(x)).length,0);
        s+= inter(pref.matrix,p.matrix)*2;
        if(pref.hobby && p.hobby && p.hobby.toLowerCase().includes(pref.hobby.toLowerCase())) s+=3;
        if(pref.deal){
          const ok=Object.keys(pref.matrix).every(k=>pref.matrix[k].length===0 || pref.matrix[k].some(t=>p.matrix[k]?.includes(t)));
          if(!ok) return -1;
        }
        return s;
      },
      match(){
        if(!store.get('session')){toast(i18n.t('toastLoginNeeded'));return;}
        $('#match_results').innerHTML='<p class="help">ìš´ì˜ìê°€ ë§¤ì¹­ì„ ì§„í–‰í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.</p>';
      }
    };

    // ---- Chat + Meeting (mock) ----
    const chat={
      async send(){
        const box=$('#chat_input');
        const txt=box.value.trim();
        if(!txt) return;
        box.value='';
        if(!window.__CURRENT_CONV_ID__) return;
        await sendMessage(window.__CURRENT_CONV_ID__, txt, detect(txt));
        renderMessage({ sender: window.__CURRENT_UID__, text: txt });
      },
      requestMeet(type){
        const st={type,status:'ëŒ€ê¸°',ts:Date.now()};
        store.set('meet_req',st);
        $('#meet_status').textContent=i18n.t(type==='offline'?'meetOfflineStatus':'meetOnlineStatus');
      }
    };
    function detect(t){return /[ã-ã‚“ã‚¡-ãƒ¶ä¸€-é¾¯]/.test(t)?'JA':/[ê°€-í£]/.test(t)?'KO':'EN'}
    function escapeHtml(s){return s.replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m]))}


    // ---- Init ----
    function init(){
      fillMBTI();
      buildMatrix('#matrix','self');
      buildMatrix('#matrixPref','pref');
      const savedLang = store.get('lang','ko');
      i18n.set(savedLang);
      const langSel=document.getElementById('langSel');
      if(langSel) langSel.addEventListener('change',e=>i18n.set(e.target.value));
      ui.refreshNav();
      ui.homeCTA();
      afterSignInHook();
      const lastEmail=store.get('last_email','');
      const lastPw=store.get('last_pw','');
      if(document.getElementById('li_email')) document.getElementById('li_email').value=lastEmail;
      if(document.getElementById('li_pw')) document.getElementById('li_pw').value=lastPw;
      if(document.getElementById('su_email')) document.getElementById('su_email').value=lastEmail;
      if(sb?.auth){
        sb.auth.onAuthStateChange((_e, session)=>{
          if(session) afterSignInHook(session.user); else beforeSignOutHook();
        });
      }
      ui.go('home');
      $('#userBadge').setAttribute('role','button');
      $('#userBadge').addEventListener('click',()=>{ if(!store.get('session')) ui.openAuth(); });
      bindEnter('#li_email, #li_pw', auth.login);
      bindEnter('#su_email, #su_nick, #su_pw', auth.signup);
      bindEnter('#su_verify_target', auth.sendCode);
      bindEnter('#su_code', auth.verifyCode);
      bindEnter('#profile input, #profile select', ui.nextFromStep2);
      bindEnter('#prefs input, #prefs select', data.savePrefs);
      const box=document.querySelector('#chat_input');
      box.addEventListener('keydown',(e)=>{
        const enterToSend=document.querySelector('#enter_send')?.checked;
        if(e.key==='Enter' && !e.shiftKey){
          if(enterToSend){
            e.preventDefault();
            chat.send();
          }
        }
      });
    }
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
